import{r as o,u as he,j as e,S as w,L as _}from"./index-BwjIhAk5.js";import{X as fe,D as z}from"./DataTableSettings-DsshIM33.js";import{m as pe,c as je}from"./index-6cARXTD6.js";import{F as ge,a as Ne,b as ve,d as be,e as Se}from"./index-BFbuKzBk.js";import{a as T}from"./AxiosInterceptor-C0G1OxbU.js";import{L as ye,y as I}from"./index-DBZWtKGJ.js";import{G as Ce,O as m}from"./index-BZ-hmF14.js";import{a as De,b as Ee,d as H,e as $}from"./index-DqFMOxbS.js";import{a as Oe}from"./index-D0LwIwlf.js";import{a as we}from"./index-C7jdaNTX.js";import{D as Y}from"./index.es-44qqu0er.js";/* empty css                         */import{F as l}from"./Form-Cyv1odcU.js";import{B as C}from"./Button-BDb3Qyxz.js";import{I as n}from"./InputGroup-B5T7iIyR.js";import"./iconBase-i6NgAem3.js";import"./index-BjX9kMhX.js";import"./floating-ui.dom-Dzl9TWyw.js";import"./Col-BeHysn_4.js";const Xe=()=>{var W;const D={discountID:"",discountName:"",discountRate:"",discountStart:"",discountEnd:"",prefix:"",onGrossOrNet:"",discountOn:""},h=[{label:"Amount",value:"A"},{label:"Percentage",value:"P"}],f=[{label:"GENERAL DISCOUNT",value:"GNRL"},{label:"ANNIVERSERY AND BDAY DISCOUNT",value:"BANI"},{label:"SPECIAL DISCOUNT FOR A PERIOD",value:"SPLP"}],p=[{label:"With Gross",value:"G"},{label:"Without Gross",value:"N"}],[s,v]=o.useState(D),[a,E]=o.useState({}),R=he(),[i,X]=o.useState({});o.useEffect(()=>{var t;(t=R.state)!=null&&t.permissions&&X(R.state.permissions)},[(W=R.state)==null?void 0:W.permissions]);const M=o.useRef(!1),[J,Te]=o.useState(!1),[L,K]=o.useState(""),[Q,Z]=o.useState([]),ee=["itemGroupName","isActive"],[G,O]=o.useState(!1),[te,k]=o.useState(!1),[se,B]=o.useState(!1),[ae,j]=o.useState(!1),ne=()=>B(!1),ie=()=>B(!0),[oe,A]=o.useState(!1),[b,F]=o.useState(null),q=()=>{k(!1),v(D),E({}),O(!1)},re=()=>{v(D),O(!1),E({}),k(!0)};o.useEffect(()=>{M.current||(M.current=!0,P())},[]);const P=async()=>{var t,r;j(!0);try{const c=await T.get("/discount"),S=(r=(t=c==null?void 0:c.data)==null?void 0:t.list)==null?void 0:r.sort((y,g)=>new Date(g.createdDate)-new Date(y.createdDate));Z(S)}catch(c){console.error("Error fetching table data",c)}finally{j(!1)}},x=(t,r)=>{v(c=>({...c,[t]:r})),E(c=>({...c,[t]:""}))},ce=()=>{const{discountName:t,discountRate:r,discountStart:c,discountEnd:S,prefix:y,onGrossOrNet:g,discountOn:N}=s,d={};let u=!0;return t||(u=!1,d.discountName="Discount name is required."),r||(u=!1,d.discountRate="Discount rate is required"),c||(u=!1,d.discountStart="Start date & time is required"),S||(u=!1,d.discountEnd="End date & time is required"),y||(u=!1,d.prefix="Prefix is required"),g||(u=!1,d.onGrossOrNet="Gross or Net is required"),N||(u=!1,d.discountOn="Discount type is required"),E(d),u},le=t=>{O(!0),v({discountID:t.discountID,discountName:t.discountName,discountRate:t.discountRate,discountStart:t.discountStart,discountEnd:t.discountEnd,onGrossOrNet:t.onGrossOrNet,prefix:t.prefix,discountOn:t.discountOn,isActive:t.isActive}),k(!0)},de=(t,r)=>{F({id:t,name:r}),A(!0)},ue=()=>{b&&(j(!0),T.delete(`/discount/${b.id}`).then(t=>{I.success(t.data.successMessage||"Discount deleted successfully!"),P()}).catch(t=>{console.error("Error deleting discount:",t),I.error("Failed to delete discount.")}).finally(()=>{j(!1),A(!1),F(null)}))},V=()=>{A(!1),F(null)},me=[{name:e.jsx("h5",{children:"Discount Name"}),selector:t=>t.discountName,sortable:!0},{name:e.jsx("h5",{children:"Discount Rate"}),selector:t=>`${t.discountRate}%`,sortable:!0},{name:e.jsx("h5",{children:"Start Date & Time"}),selector:t=>new Date(t.discountStart).toLocaleString(),sortable:!0},{name:e.jsx("h5",{children:"End Date & Time"}),selector:t=>new Date(t.discountEnd).toLocaleString(),sortable:!0},{name:e.jsx("h5",{children:"Status"}),cell:t=>e.jsx("span",{style:{color:t.isActive?"#88E788":"#FF474C",fontWeight:"bold"},children:t.isActive?"Active":"Inactive"}),sortable:!0},{name:e.jsx("h5",{children:"Action"}),center:!0,cell:t=>e.jsxs(e.Fragment,{children:[(i==null?void 0:i.write)&&e.jsx(_,{className:"action-icon",onClick:()=>le(t),children:e.jsx(Se,{size:24,color:"#87CEEB"})}),(i==null?void 0:i.delete)&&e.jsx(_,{className:"action-icon",onClick:()=>de(t.discountID,t.discountName),children:e.jsx(je,{size:30,style:{margin:"1vh"},color:"#FF474C"})})]})}],xe=o.useMemo(()=>e.jsxs("div",{className:"d-flex justify-content-end gap-2 align-items-center w-100",children:[e.jsx(l,{className:"d-flex",children:e.jsx(l.Control,{type:"search",placeholder:"Search...",className:"me-2 rounded-pill","aria-label":"Search",onChange:t=>K(t.target.value)})}),(i==null?void 0:i.import)&&e.jsxs(C,{variant:"info",onClick:ie,children:[e.jsx(De,{size:20})," Import"]}),(i==null?void 0:i.export)&&e.jsxs(C,{variant:"success",children:[e.jsx(Ee,{size:20})," Export"]}),(i==null?void 0:i.write)&&e.jsxs(C,{variant:"warning",onClick:re,children:[e.jsx(Ce,{size:20})," Add"]})]}),[i,L]),U=async t=>{if(t.preventDefault(),!ce())return;const r=new Date(s.discountStart),c=new Date(s.discountEnd),S=r.toISOString(),y=c.toISOString(),g={discountName:s.discountName,discountRate:s.discountRate,discountStart:S,discountEnd:y,prefix:s.prefix,onGrossOrNet:s.onGrossOrNet,discountOn:s.discountOn,isActive:s.isActive};j(!0);try{let N;G?N=await T.put(`/discount/${s.discountID}`,g):N=await T.post("/discount",g),v(D),O(!1),q(),P(),I.success(N.data.successMessage||"Success!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch{I.error(res.data.ErrorMessage||"Something went wrong! Please try again.",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}finally{j(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(ye,{}),oe&&e.jsx("div",{className:"modal fade show",style:{display:"block",backgroundColor:"rgba(0, 0, 0, 0.5)",transition:"opacity 0.3s ease-in-out"},tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content border-0 shadow-lg rounded-4 animate__animated animate__fadeInDown",children:[e.jsxs("div",{className:"modal-header bg-danger text-white rounded-top-4",children:[e.jsxs("h5",{className:"modal-title d-flex align-items-center gap-2",children:[e.jsx(ge,{}),"Confirm Deletion"]}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:V})]}),e.jsx("div",{className:"modal-body text-center",children:e.jsxs("p",{className:"fs-5 mb-0",children:["Are you sure you want to delete"," ",e.jsx("strong",{children:b==null?void 0:b.name}),"?"]})}),e.jsxs("div",{className:"modal-footer justify-content-center border-0 pb-4",children:[e.jsxs("button",{type:"button",className:"btn btn-secondary rounded text-white px-4 d-flex align-items-center gap-2",onClick:V,children:[e.jsx(Ne,{}),"Cancel"]}),e.jsxs("button",{type:"button",className:"btn btn-danger text-white rounded px-4 shadow d-flex align-items-center gap-2",onClick:ue,children:[e.jsx(ve,{}),"Yes, Delete"]})]})]})})}),ae?e.jsxs("div",{className:"d-flex justify-content-center",style:{marginTop:"20%"},children:[e.jsx(w,{animation:"grow",variant:"secondary",size:"sm"}),e.jsx(w,{animation:"grow",variant:"warning"}),e.jsx(w,{animation:"grow",variant:"secondary",size:"sm"}),e.jsx(w,{animation:"grow",variant:"warning"})]}):e.jsx("div",{className:"d-flex",children:e.jsx("div",{className:"p-3",style:{width:"100vw"},children:e.jsx("div",{style:{width:"100%"},children:e.jsx(fe,{columns:me,data:z.filterItems(Q,ee,L),pagination:!0,paginationPerPage:z.paginationPerPage,paginationRowsPerPageOptions:z.paginationRowsPerPageOptions,progressPending:J,subHeader:!0,fixedHeaderScrollHeight:"400px",subHeaderComponent:xe,persistTableHead:!0})})})}),e.jsxs(m,{show:te,onHide:q,placement:"end",backdrop:"false",style:{"--bs-offcanvas-width":"800px"},children:[e.jsx(m.Header,{closeButton:!0,children:e.jsx("div",{className:"w-100 text-center",children:e.jsx(m.Title,{style:{fontSize:"30px",fontWeight:600},children:G?"Edit Discount":"Add Discount"})})}),e.jsx(m.Body,{style:{marginTop:"-2vh"},children:e.jsxs(l,{className:"h-90",onSubmit:U,children:[e.jsxs(n,{className:"mb-4",children:[e.jsx(n.Text,{id:"discountName",children:e.jsx(pe,{size:25,color:"#ffc800"})}),e.jsx(l.Control,{name:"discountName",value:s.discountName||"",onChange:t=>x("discountName",t.target.value),placeholder:"Discount name","aria-label":"discountName",isInvalid:!!a.discountName,isValid:s.discountName&&!a.discountName,autoComplete:"off"}),a.discountName&&e.jsx("span",{className:"error-msg",children:a.discountName})]}),e.jsxs(n,{className:"mb-4",children:[e.jsx(n.Text,{id:"discountRate",children:e.jsx(H,{size:25,color:"#ffc800"})}),e.jsx(l.Control,{name:"discountRate",value:s.discountRate||"",onChange:t=>{const r=t.target.value;/^\d*%?$/.test(r)&&x("discountRate",r)},placeholder:"Discount rate","aria-label":"discountRate",isInvalid:!!a.discountRate,isValid:s.discountRate&&!a.discountRate,autoComplete:"off"}),a.discountRate&&e.jsx("span",{className:"error-msg",children:a.discountRate})]}),e.jsxs(n,{className:"mb-4",children:[e.jsx(n.Text,{id:"discountStart",children:e.jsx($,{size:25,color:"#ffc800"})}),e.jsx(Y,{className:"form-control custom-datepicker",selected:s.discountStart?new Date(s.discountStart):null,onChange:t=>x("discountStart",t),showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:15,dateFormat:"MMMM d, yyyy h:mm aa",placeholderText:"Start Date & Time"}),a.discountStart&&e.jsx("span",{className:"error-msg",children:a.discountStart})]}),e.jsxs(n,{className:"mb-4",children:[e.jsx(n.Text,{id:"discountEnd",children:e.jsx($,{size:25,color:"#ffc800"})}),e.jsx(Y,{className:"form-control custom-datepicker",selected:s.discountEnd?new Date(s.discountEnd):null,onChange:t=>x("discountEnd",t),showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:15,dateFormat:"MMMM d, yyyy h:mm aa",placeholderText:"End Date & Time"}),a.discountEnd&&e.jsx("span",{className:"error-msg",children:a.discountEnd})]}),e.jsxs(n,{className:"mb-4",children:[e.jsx(n.Text,{id:"discountOn",children:e.jsx(H,{size:25,color:"#ffc800"})}),e.jsxs(l.Select,{name:"discountOn",value:s.discountOn||"",onChange:t=>x("discountOn",t.target.value),children:[e.jsx("option",{value:"",children:"Select discount type"}),s.discountOn&&!(h!=null&&h.some(t=>t.value===s.discountOn))&&e.jsx("option",{value:s.discountOn,children:s.discountOn}),h==null?void 0:h.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),a.discountOn&&e.jsx("span",{className:"error-msg",children:a.discountOn})]}),e.jsxs(n,{className:"mb-4",children:[e.jsx(n.Text,{id:"prefix",children:e.jsx(we,{size:25,color:"#ffc800"})}),e.jsxs(l.Select,{name:"prefix",value:s.prefix||"",onChange:t=>x("prefix",t.target.value),children:[e.jsx("option",{value:"",children:"Select prefix"}),s.prefix&&!(f!=null&&f.some(t=>t.value===s.prefix))&&e.jsx("option",{value:s.prefix,children:s.prefix}),f==null?void 0:f.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),a.prefix&&e.jsx("span",{className:"error-msg",children:a.prefix})]}),e.jsxs(n,{className:"mb-4",children:[e.jsx(n.Text,{id:"onGrossOrNet",children:e.jsx(H,{size:25,color:"#ffc800"})}),e.jsxs(l.Select,{name:"onGrossOrNet",value:s.onGrossOrNet||"",onChange:t=>x("onGrossOrNet",t.target.value),children:[e.jsx("option",{value:"",children:"Select  Gross / Net"}),s.onGrossOrNet&&!(p!=null&&p.some(t=>t.value===s.onGrossOrNet))&&e.jsx("option",{value:s.onGrossOrNet,children:s.onGrossOrNet}),p==null?void 0:p.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),a.onGrossOrNet&&e.jsx("span",{className:"error-msg",children:a.onGrossOrNet})]}),e.jsxs(n,{className:"mb-3",children:[e.jsx(n.Text,{id:"isActive",children:e.jsx(Oe,{size:25,color:"#ffc800"})}),e.jsxs(l.Check,{type:"checkbox",id:"custom-checkbox",label:"IsActive",name:"isActive",className:"ms-3",style:{display:"flex",alignItems:"center",fontSize:"1rem"},custom:"true",children:[e.jsx(l.Check.Input,{type:"checkbox",checked:s.isActive,style:{width:"20px",height:"20px",cursor:"pointer",marginRight:"8px"}}),e.jsx(l.Check.Label,{htmlFor:"custom-checkbox",children:"IsActive"})]})]}),e.jsx("div",{className:"d-flex justify-content-center mt-4",children:e.jsx(C,{type:"submit",variant:"warning",children:G?"Update":"Save"})})]})})]}),e.jsxs(m,{show:se,onHide:ne,backdrop:"static",placement:"end",children:[e.jsx(m.Header,{closeButton:!0,children:e.jsx("div",{className:"w-100 text-center",children:e.jsx(m.Title,{style:{fontSize:"30px",fontWeight:600},children:"Add File"})})}),e.jsx(m.Body,{style:{marginTop:"-2vh"},children:e.jsxs(l,{className:"h-90",onSubmit:U,children:[e.jsxs(n,{className:"mb-3",children:[e.jsx(n.Text,{id:"itemGroupName",children:e.jsx(be,{size:25,color:"#ffc800"})}),e.jsx(l.Control,{type:"file"})]}),e.jsx("div",{className:"d-flex justify-content-center mt-5",children:e.jsx(C,{type:"submit",variant:"warning",children:"Save"})})]})})]})]})};export{Xe as default};
