import{u as ge,r as o,j as e,S as D,L as J}from"./index-BwjIhAk5.js";import{X as ye,D as M}from"./DataTableSettings-DsshIM33.js";import{b as be,a as ve,M as Ne,o as Ie,p as Ce,q as we,c as De}from"./index-6cARXTD6.js";import{F as Te,a as Se,b as Ee,o as Ae,p as ze,d as ke,e as Fe}from"./index-BFbuKzBk.js";import{a as g}from"./AxiosInterceptor-C0G1OxbU.js";import{L as Pe,y as T}from"./index-DBZWtKGJ.js";import{G as Me,O as x}from"./index-BZ-hmF14.js";import{a as Oe,b as Be}from"./index-DqFMOxbS.js";import{B as Ve,a as O,b as qe,c as He}from"./index-x1L1wPfd.js";import{a as Ge}from"./index-D0LwIwlf.js";import{D as B}from"./index.es-44qqu0er.js";/* empty css                         */import{F as c}from"./Form-Cyv1odcU.js";import{B as b}from"./Button-BDb3Qyxz.js";import{R as j}from"./Row-D6dYXthX.js";import{C as h}from"./Col-BeHysn_4.js";import{I as a}from"./InputGroup-B5T7iIyR.js";import"./iconBase-i6NgAem3.js";import"./index-BjX9kMhX.js";import"./floating-ui.dom-Dzl9TWyw.js";const os=()=>{const S=ge(),[m,W]=o.useState({});o.useEffect(()=>{var s;(s=S.state)!=null&&s.permissions&&W(S.state.permissions)},[S.state]);const V=o.useRef(!1),Z=localStorage.getItem("channelId"),v={employeeID:"",psId:"",employeeName:"",password:"",email:"",mobile:"",joiningDate:"",deptId:"",empTypeId:"",empCode:"",isActive:!1,securityQuestionId:"",securityAnswer:"",dob:"",anniversary:"",designation:""},[_,Y]=o.useState(!0);o.useEffect(()=>{const s=setTimeout(()=>{Y(!1)},2e3);return()=>clearTimeout(s)},[]);const[t,p]=o.useState(v),[n,f]=o.useState({}),[X,E]=o.useState(!1),[A,U]=o.useState([]),[z,K]=o.useState([]),[q,ee]=o.useState(""),[se,te]=o.useState([]),ae=["itemGroupName","itemGroupCode","isActive"],[N,I]=o.useState(!1),[ie,k]=o.useState(!1),[ne,H]=o.useState(!1),[le,F]=o.useState(!1),[y,P]=o.useState(null),re=()=>H(!1),oe=()=>H(!0),G=()=>{k(!1),p(v),f({}),I(!1)},ce=()=>{p(v),I(!1),f({}),k(!0),de(),me()};o.useEffect(()=>{V.current||(V.current=!0,C())},[]);const de=async()=>{var s;try{const i=await g.get("/department");U((s=i==null?void 0:i.data)==null?void 0:s.list)}catch(i){E(!1),console.error("Error fetching department data",i)}},me=async()=>{var s;try{const i=await g.get("/employeetype");K((s=i==null?void 0:i.data)==null?void 0:s.list)}catch(i){E(!1),console.error("Error fetching employee data",i)}},C=async()=>{var s,i;try{const l=await g.get("/employee"),u=(i=(s=l==null?void 0:l.data)==null?void 0:s.list)==null?void 0:i.sort((d,r)=>new Date(r.createdDate)-new Date(d.createdDate));te(u)}catch(l){E(!1),console.error("Error fetching table data",l)}},w=(s,i)=>{p(l=>({...l,[s]:i})),f(l=>({...l,[s]:""}))},pe=()=>{const{employeeName:s,password:i,email:l,mobile:u}=t,d={};let r=!0;if(s?/^[a-zA-Z ]+$/.test(s)||(d.employeeName="Name must contain only letters",r=!1):(r=!1,d.employeeName="Group name is required."),i?i.length<6&&(d.employeeName="Must be at least 6 characters",r=!1):(r=!1,d.password="password is required."),l.trim()?/^[a-zA-Z][^\s@]+@[^\s@]+\.[^\s@]+$/.test(l)||(d.email="Email is invalid",r=!1):(r=!1,d.email="Email is required."),u.trim()?/^[0-9]{10}$/.test(u)||(d.mobile="Phone must be 10 digits",r=!1):(r=!1,d.mobile="Mobile number is required."),!t.joiningDate)d.joiningDate="Joining date is required";else{const Q=new Date(t.joiningDate),$=new Date;Q.setHours(0,0,0,0),$.setHours(0,0,0,0),Q>$&&(d.joiningDate="Joining date cannot be in the future")}return f(d),r},he=s=>{I(!0),p({employeeID:s.employeeID,psId:s.psid,employeeName:s.name,password:"",email:s.email,mobile:s.mobile,joiningDate:s.joiningDate,deptId:s.deptId,empTypeId:s.empTypeId,empCode:s.empCode,isActive:s.isActive,securityQuestionId:s.securityQuestionID,securityAnswer:s.answer,dob:s.dob,anniversary:s.doa,designation:s.designation}),k(!0)},ue=(s,i)=>{P({id:s,name:i}),F(!0)},xe=()=>{y&&g.delete(`/employee/${y.id}`).then(s=>{T.success(s.data.successMessage||"Employee deleted successfully!"),C()}).catch(s=>{console.error("Error deleting employee:",s),T.error("Failed to delete employee.")}).finally(()=>{F(!1),P(null)})},R=()=>{F(!1),P(null)},je=[{name:e.jsx("h5",{children:"Joining Date"}),selector:s=>{const i=new Date(s.joiningDate),l=String(i.getDate()).padStart(2,"0"),u=String(i.getMonth()+1).padStart(2,"0"),d=i.getFullYear();return`${l}-${u}-${d}`},sortable:!0},{name:e.jsx("h5",{children:"Name"}),selector:s=>s.name,sortable:!0},{name:e.jsx("h5",{children:"Email"}),selector:s=>s.email,sortable:!0},{name:e.jsx("h5",{children:"Mobile Number"}),selector:s=>s.mobile,sortable:!0},{name:e.jsx("h5",{children:"Designation"}),selector:s=>s.designation,sortable:!0},{name:e.jsx("h5",{children:"Status"}),cell:s=>e.jsx("span",{style:{color:s.isActive?"#88E788":"#FF474C",fontWeight:"bold"},children:s.isActive?"Active":"Inactive"}),sortable:!0},{name:e.jsx("h5",{children:"Action"}),center:!0,cell:s=>e.jsxs(e.Fragment,{children:[(m==null?void 0:m.write)&&e.jsx(J,{className:"action-icon",onClick:()=>he(s),children:e.jsx(Fe,{size:24,color:"#87CEEB"})}),(m==null?void 0:m.delete)&&e.jsx(J,{className:"action-icon",onClick:()=>ue(s.employeeID,s.name),children:e.jsx(De,{size:30,style:{margin:"1vh"},color:"#FF474C"})})]})}],fe=o.useMemo(()=>e.jsxs("div",{className:"d-flex justify-content-end gap-2 align-items-center w-100",children:[e.jsx(c,{className:"d-flex",children:e.jsx(c.Control,{type:"search",placeholder:"Search...",className:"me-2 rounded-pill","aria-label":"Search",onChange:s=>ee(s.target.value)})}),(m==null?void 0:m.import)&&e.jsxs(b,{variant:"info",onClick:oe,children:[e.jsx(Oe,{size:20,style:{marginTop:"-0.5vh"}})," Import"]}),(m==null?void 0:m.export)&&e.jsxs(b,{variant:"success",children:[e.jsx(Be,{size:20,style:{marginTop:"-0.5vh"}})," Export"]}),(m==null?void 0:m.write)&&e.jsxs(b,{variant:"warning",onClick:ce,children:[e.jsx(Me,{size:20,style:{marginTop:"-0.5vh"}})," Add"]})]}),[m,q]),L=async s=>{var u,d;if(s.preventDefault(),!pe())return;const i={channelID:Z,psid:t.psId,name:t.employeeName,password:t.password,email:t.email,mobile:t.mobile,joiningDate:t.joiningDate,deptId:t.deptId,empTypeId:t.empTypeId,empCode:t.empCode,isActive:t.isActive},l={...i,securityQuestionID:t.securityQuestionId,answer:t.securityAnswer,dob:t.dob,doa:t.anniversary,designation:t.designation};try{let r;N?r=await g.put(`/employee/${t.employeeID}`,l):r=await g.post("/employee",i),p(v),I(!1),G(),C(),T.success(r.data.successMessage||"Success!")}catch(r){T.error(((d=(u=r==null?void 0:r.response)==null?void 0:u.data)==null?void 0:d.ErrorMessage)||"Something went wrong! Please try again.")}C()};return e.jsxs(e.Fragment,{children:[e.jsx(Pe,{}),le&&e.jsx("div",{className:"modal fade show",style:{display:"block",backgroundColor:"rgba(0, 0, 0, 0.5)",transition:"opacity 0.3s ease-in-out"},tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content border-0 shadow-lg rounded-4 animate__animated animate__fadeInDown",children:[e.jsxs("div",{className:"modal-header bg-danger text-white rounded-top-4",children:[e.jsxs("h5",{className:"modal-title d-flex align-items-center gap-2",children:[e.jsx(Te,{}),"Confirm Deletion"]}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:R})]}),e.jsx("div",{className:"modal-body text-center",children:e.jsxs("p",{className:"fs-5 mb-0",children:["Are you sure you want to delete"," ",e.jsx("strong",{children:y==null?void 0:y.name}),"?"]})}),e.jsxs("div",{className:"modal-footer justify-content-center border-0 pb-4",children:[e.jsxs("button",{type:"button",className:"btn btn-secondary rounded text-white px-4 d-flex align-items-center gap-2",onClick:R,children:[e.jsx(Se,{}),"Cancel"]}),e.jsxs("button",{type:"button",className:"btn btn-danger text-white rounded px-4 shadow d-flex align-items-center gap-2",onClick:xe,children:[e.jsx(Ee,{}),"Yes, Delete"]})]})]})})}),_?e.jsxs("div",{className:"d-flex justify-content-center",style:{marginTop:"20%"},children:[e.jsx(D,{animation:"grow",variant:"secondary",size:"sm"}),e.jsx(D,{animation:"grow",variant:"warning"}),e.jsx(D,{animation:"grow",variant:"secondary",size:"sm"}),e.jsx(D,{animation:"grow",variant:"warning"})]}):e.jsx("div",{className:"d-flex",children:e.jsx("div",{className:"p-3",style:{width:"100vw"},children:e.jsx(ye,{className:"DataTable",columns:je,data:M.filterItems(se,ae,q),pagination:!0,paginationPerPage:M.paginationPerPage,paginationRowsPerPageOptions:M.paginationRowsPerPageOptions,progressPending:X,subHeader:!0,fixedHeaderScrollHeight:"400px",subHeaderComponent:fe,persistTableHead:!0})})}),e.jsxs(x,{show:ie,onHide:G,placement:"end",backdrop:"false",className:"custom-canvas",style:{"--bs-offcanvas-width":"1000px"},children:[e.jsx(x.Header,{closeButton:!0,children:e.jsx("div",{className:"w-100 text-center",children:e.jsx(x.Title,{style:{fontSize:"30px",fontWeight:600},children:N?"Edit Employee":"Add Employee"})})}),e.jsx(x.Body,{className:"row",style:{marginTop:"-2vh"},children:e.jsxs(c,{className:"h-90 ",onSubmit:s=>L(s),children:[e.jsxs(j,{children:[e.jsx(h,{md:6,children:e.jsxs(a,{className:"mb-4",children:[e.jsx(a.Text,{id:"itemGroupName",children:e.jsx(be,{size:25,color:"#ffc800"})}),e.jsx(c.Control,{name:"itemGroupName",value:t.employeeName||"",onChange:s=>w("employeeName",s.target.value.replace(/[^a-zA-Z ]/g,"")),placeholder:"Employee name","aria-label":"itemGroupName",isInvalid:!!n.employeeName,isValid:t.employeeName&&!n.employeeName}),n.itemGroupName&&e.jsx("span",{className:"error-msg",children:n.itemGroupName})]})}),e.jsx(h,{md:6,children:e.jsxs(a,{hasValidation:!0,className:"mb-4",children:[e.jsx(a.Text,{children:e.jsx(ve,{size:24,color:"#ffc800"})}),e.jsx(c.Control,{type:"password",name:"Password",value:t.password||"",onChange:s=>w("password",s.target.value),className:n.password?"input-error":"",autoComplete:"off",required:!0,placeholder:"Password",isInvalid:!!n.password,isValid:t.password&&!n.password})]})})]}),e.jsxs(j,{children:[e.jsx(h,{md:6,children:e.jsxs(a,{hasValidation:!0,className:"mb-4",children:[e.jsx(a.Text,{children:e.jsx(Ne,{size:25,color:"#ffc800"})}),e.jsx(c.Control,{type:"text",value:t.email,required:!0,placeholder:"Email Address",isInvalid:!!n.email,isValid:t.email&&!n.email,onChange:s=>{const i=s.target.value.charAt(0);if(!/[a-zA-Z]/.test(i)&&s.target.value.length>0){f({...n,email:"Email must start with a letter"});return}else{const l={...n};delete l.email,f(l)}p({...t,email:s.target.value})}})]})}),e.jsx(h,{md:6,children:e.jsxs(a,{hasValidation:!0,className:"mb-4",children:[e.jsx(a.Text,{children:e.jsx(Ve,{size:24,color:"#ffc800"})}),e.jsx(c.Control,{type:"text",value:t.mobile,required:!0,placeholder:"Mobile Number",isInvalid:!!n.mobile,isValid:t.mobile&&!n.mobile,onChange:s=>p({...t,mobile:s.target.value.replace(/[^0-9]/g,"")})})]})})]}),e.jsxs(j,{children:[e.jsx(h,{md:6,children:e.jsxs(a,{hasValidation:!0,className:"mb-4",children:[e.jsx(a.Text,{children:e.jsx(O,{size:24,color:"#ffc800"})}),e.jsx(B,{className:"form-control",selected:t.joiningDate?new Date(t.joiningDate):null,onChange:s=>p({...t,joiningDate:s.toISOString().split("T")[0]}),placeholderText:"Joining Date"})]})}),e.jsx(h,{md:6,children:e.jsxs(a,{className:"mb-4",children:[e.jsx(a.Text,{id:"psid",children:e.jsx(Ae,{size:25,color:"#ffc800"})}),e.jsx(c.Control,{name:"psid",value:t.psId||"",onChange:s=>w("psId",s.target.value),placeholder:"Enter PS Id","aria-label":"psid",isInvalid:!!n.psId,isValid:t.psId&&!n.psId})]})})]}),e.jsxs(j,{children:[e.jsx(h,{md:6,children:e.jsxs(a,{className:"mb-4",children:[e.jsx(a.Text,{id:"psid",children:e.jsx(ze,{size:25,color:"#ffc800"})}),e.jsx(c.Control,{name:"psid",value:t.empCode||"",onChange:s=>w("empCode",s.target.value),placeholder:"Enter EMP Code","aria-label":"psid",isInvalid:!!n.empCode,isValid:t.empCode&&!n.empCode})]})}),e.jsx(h,{md:6,children:e.jsxs(a,{className:"mb-4",children:[e.jsx(a.Text,{id:"employeeTypeId",children:e.jsx(qe,{size:25,color:"#ffc800"})}),e.jsxs(c.Select,{value:t.empTypeId,onChange:s=>p({...t,empTypeId:s.target.value}),required:!0,isInvalid:!!n.empTypeId,children:[e.jsx("option",{value:"",children:"Select Employee Type"}),z==null?void 0:z.map(s=>e.jsx("option",{value:s.empTypeId,children:s.empTypeName},s.empTypeId))]})]})})]}),e.jsxs(j,{children:[e.jsx(h,{md:6,children:e.jsxs(a,{className:"mb-4",children:[e.jsx(a.Text,{id:"departmentId",children:e.jsx(He,{size:25,color:"#ffc800"})}),e.jsxs(c.Select,{value:t.deptId,onChange:s=>p({...t,deptId:s.target.value}),required:!0,isInvalid:!!n.deptId,children:[e.jsx("option",{value:"",children:"Select Department Type"}),A==null?void 0:A.map(s=>e.jsx("option",{value:s.deptId,children:s.deptName},s.deptId))]})]})}),e.jsx(h,{md:6,children:e.jsxs(a,{className:"mb-4",children:[e.jsx(a.Text,{id:"isActive",children:e.jsx(Ge,{size:25,color:"#ffc800"})}),e.jsxs(c.Check,{type:"checkbox",id:"custom-checkbox",label:"IsActive",name:"isActive",className:"ms-3",style:{display:"flex",alignItems:"center",fontSize:"1rem"},custom:"true",children:[e.jsx(c.Check.Input,{type:"checkbox",className:"custom-yellow-checkbox",onChange:s=>p({...t,isActive:s.target.checked}),checked:t.isActive,style:{width:"20px",height:"20px",cursor:"pointer",marginRight:"8px"}}),e.jsx(c.Check.Label,{htmlFor:"custom-checkbox",children:"IsActive"})]})]})})]}),N&&e.jsxs(e.Fragment,{children:[e.jsxs(j,{children:[e.jsx(h,{md:6,children:e.jsxs(a,{className:"mb-4",children:[e.jsx(a.Text,{children:e.jsx(Ie,{size:25,color:"#ffc800"})}),e.jsxs(c.Select,{value:t.securityQuestionId,onChange:s=>p({...t,securityQuestionId:s.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select Security Question"}),e.jsx("option",{value:"90",children:"90"}),e.jsx("option",{value:"67",children:"67"}),e.jsx("option",{value:"80",children:"80"})]})]})}),e.jsx(h,{md:6,children:e.jsxs(a,{className:"mb-4",children:[e.jsx(a.Text,{children:e.jsx(Ce,{size:25,color:"#ffc800"})}),e.jsx(c.Control,{placeholder:"Your Answer",value:t.securityAnswer,onChange:s=>p({...t,securityAnswer:s.target.value}),required:!0})]})})]}),e.jsxs(j,{children:[e.jsx(h,{md:6,children:e.jsxs(a,{className:"mb-4",children:[e.jsx(a.Text,{children:e.jsx(O,{size:24,color:"#ffc800"})}),e.jsx(B,{className:"form-control",selected:t.dob?new Date(t.dob):null,onChange:s=>p({...t,dob:s.toISOString().split("T")[0]}),placeholderText:"Date of Birth"})]})}),e.jsx(h,{md:6,children:e.jsxs(a,{className:"mb-4",children:[e.jsx(a.Text,{children:e.jsx(O,{size:24,color:"#ffc800"})}),e.jsx(B,{className:"form-control",selected:t.anniversary?new Date(t.anniversary):null,onChange:s=>p({...t,anniversary:s.toISOString().split("T")[0]}),placeholderText:"Date of Anniversary"})]})})]}),e.jsx(j,{children:e.jsx(h,{md:6,children:e.jsxs(a,{className:"mb-4",children:[e.jsx(a.Text,{children:e.jsx(we,{size:25,color:"#ffc800"})}),e.jsx(c.Control,{placeholder:"Designation",value:t.designation,onChange:s=>p({...t,designation:s.target.value})})]})})})]}),e.jsx("div",{className:"d-flex justify-content-center mt-4",children:e.jsx(b,{type:"submit",variant:"warning",children:N?"Update":"Save"})})]})})]}),e.jsxs(x,{show:ne,onHide:re,backdrop:"static",placement:"end",children:[e.jsx(x.Header,{closeButton:!0,children:e.jsx("div",{className:"w-100 text-center",children:e.jsx(x.Title,{style:{fontSize:"30px",fontWeight:600},children:"Add File"})})}),e.jsx(x.Body,{style:{marginTop:"-2vh"},children:e.jsxs(c,{className:"h-90",onSubmit:L,children:[e.jsxs(a,{className:"mb-3",children:[e.jsx(a.Text,{id:"itemGroupName",children:e.jsx(ke,{size:25,color:"#ffc800"})}),e.jsx(c.Control,{type:"file"})]}),e.jsx("div",{className:"d-flex justify-content-center mt-5",children:e.jsx(b,{type:"submit",variant:"warning",children:"Submit"})})]})})]})]})};export{os as default};
