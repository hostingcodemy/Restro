import{u as xe,r,j as e,S as b,L as V}from"./index-BwjIhAk5.js";import{X as fe,D as I}from"./DataTableSettings-DsshIM33.js";import{b as ge,c as je}from"./index-6cARXTD6.js";import{F as ve,a as be,b as ye,c as Ce,d as Ge,e as Ne}from"./index-BFbuKzBk.js";import{G as we,O as c}from"./index-BZ-hmF14.js";import{a as Se,b as Fe}from"./index-DqFMOxbS.js";import{a as Ee}from"./index-D0LwIwlf.js";import{L as Ie,y as h}from"./index-DBZWtKGJ.js";import{a as x}from"./AxiosInterceptor-C0G1OxbU.js";import{F as d}from"./Form-Cyv1odcU.js";import{B as g}from"./Button-BDb3Qyxz.js";import{I as m}from"./InputGroup-B5T7iIyR.js";import"./iconBase-i6NgAem3.js";import"./index-BjX9kMhX.js";import"./Col-BeHysn_4.js";const We=()=>{var O;const y=xe(),k=r.useRef(!1),[o,q]=r.useState({});r.useEffect(()=>{var t;(t=y.state)!=null&&t.permissions&&q(y.state.permissions)},[(O=y.state)==null?void 0:O.permissions]);const C={itemGroupId:"",itemGroupName:"",itemGroupCode:"",isActive:!1},D={File:""},u=[{label:"FinishedGoods",value:"1"},{label:"SemiFinishedGoods",value:"2"},{label:"RawMaterial",value:"3"},{label:"Consumables",value:"4"},{label:"SpareParts",value:"5"},{label:"PackagingMaterial",value:"6"},{label:"Service",value:"7"},{label:"Other",value:"8"}],[i,j]=r.useState(C),[p,v]=r.useState({}),[T,A]=r.useState(D),[P,z]=r.useState({}),[U,ke]=r.useState(!1),[H,_]=r.useState(""),[W,$]=r.useState([]),X=["itemGroupName","itemGroupCode","isActive"],[G,N]=r.useState(!1),[Z,w]=r.useState(!1),[Y,L]=r.useState(!1),[J,n]=r.useState(!1),[K,S]=r.useState(!1),[f,F]=r.useState(null),M=()=>{w(!1),j(C),v({}),N(!1)},Q=()=>{j(C),N(!1),v({}),w(!0)},R=()=>L(!1),ee=()=>L(!0);r.useEffect(()=>{k.current||(k.current=!0,te())},[]);const te=async()=>{var t,s;n(!0);try{const a=await x.get("/facilitystatus"),l=(s=(t=a==null?void 0:a.data)==null?void 0:t.list)==null?void 0:s.sort((pe,he)=>new Date(he.createdDate)-new Date(pe.createdDate));$(l)}catch(a){console.error("Error fetching table data",a)}finally{n(!1)}},ae=async()=>{try{const t=await x.get("/itemgroups/exportexcel",{responseType:"blob"}),s=new Blob([t.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.URL.createObjectURL(s),l=document.createElement("a");l.href=a,l.setAttribute("download","itemGroup.xlsx"),document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(a)}catch(t){console.error("Error downloading the file:",t),alert("Failed to export file.")}},E=(t,s)=>{j(a=>({...a,[t]:s})),v(a=>({...a,[t]:""}))},se=(t,s)=>{A(a=>({...a,[t]:s})),z(a=>({...a,[t]:""}))},re=()=>{const{itemGroupName:t,itemGroupCode:s}=i,a={};let l=!0;return t?/^[a-zA-Z ]+$/.test(t)||(a.itemGroupName="Name must contain only letters",l=!1):(l=!1,a.itemGroupName="Group name is required."),s||(l=!1,a.itemGroupCode="Group code is required."),v(a),l},oe=()=>{const{File:t}=T,s={};let a=!0;return t?t.type!=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&&(a=!1,s.File="Only .xlsx files are allowed."):(a=!1,s.File="Import file is required."),z(s),a},ie=t=>{N(!0),j({itemGroupId:t.itemGroupId,itemGroupName:t.itemGroupName,itemGroupCode:t.itemGroupCode,isActive:t.isActive}),w(!0)},le=(t,s)=>{F({id:t,name:s}),S(!0)},ne=()=>{f&&(n(!0),x.delete(`/itemgroups/${f.id}`).then(t=>{h.success(t.data.successMessage||"Group deleted successfully!"),fetchGroupData()}).catch(t=>{console.error("Error deleting group:",t),h.error("Failed to delete group.")}).finally(()=>{n(!1),S(!1),F(null)}))},B=()=>{S(!1),F(null)},ce=[{name:e.jsx("h5",{children:"Facility Type"}),selector:t=>t.facilityType,sortable:!0},{name:e.jsx("h5",{children:"Facility Status"}),selector:t=>t.facilityStatus,sortable:!0},{name:e.jsx("h5",{children:"Colour"}),selector:t=>t.colour,sortable:!0},{name:e.jsx("h5",{children:"Sequence"}),selector:t=>t.sequence,sortable:!0},{name:e.jsx("h5",{children:"Status"}),cell:t=>e.jsx("span",{style:{color:t.isActive?"#88E788":"#FF474C",fontWeight:"bold"},children:t.isActive?"Active":"Inactive"}),sortable:!0},{name:e.jsx("h5",{children:"Action"}),center:!0,cell:t=>e.jsxs(e.Fragment,{children:[(o==null?void 0:o.write)&&e.jsx(V,{className:"action-icon",onClick:()=>ie(t),children:e.jsx(Ne,{size:24,color:"#87CEEB"})}),(o==null?void 0:o.delete)&&e.jsx(V,{className:"action-icon",onClick:()=>le(t.itemGroupId,t.itemGroupName),children:e.jsx(je,{size:30,style:{margin:"1vh"},color:"#FF474C"})})]})}],de=r.useMemo(()=>e.jsxs("div",{className:"d-flex justify-content-end gap-2 align-items-center w-100",children:[e.jsx(d,{className:"d-flex",children:e.jsx(d.Control,{type:"search",placeholder:"Search...",className:"me-2 rounded-pill","aria-label":"Search",onChange:t=>_(t.target.value)})}),(o==null?void 0:o.import)&&e.jsxs(g,{variant:"info",onClick:ee,children:[e.jsx(Se,{size:20})," Import"]}),(o==null?void 0:o.export)&&e.jsxs(g,{variant:"success",onClick:ae,children:[e.jsx(Fe,{size:20})," Export"]}),(o==null?void 0:o.write)&&e.jsxs(g,{variant:"warning",onClick:Q,children:[e.jsx(we,{size:20})," Add"]})]}),[o,H]),me=async t=>{if(t.preventDefault(),!re())return;const s={itemGroupName:i.itemGroupName,itemGroupCode:i.itemGroupCode,isActive:i.isActive};n(!0);try{let a;G?a=await x.put(`/itemgroups/${i.itemGroupId}`,s):a=await x.post("/itemgroups",s),M(),fetchGroupData(),h.success(a.data.successMessage||"Success!")}catch{h.error("Something went wrong! Please try again.")}finally{n(!1)}},ue=async t=>{if(t.preventDefault(),!oe())return;const s=new FormData;s.append("File",T.File),n(!0);try{const a=await x.post("/itemgroups/importexcel",s);h.success(a.data.successMessage||"File uploaded successfully!"),R(),A(D)}catch{h.error("Something went wrong! Please try again.")}finally{n(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(Ie,{}),K&&e.jsx("div",{className:"modal fade show",style:{display:"block",backgroundColor:"rgba(0, 0, 0, 0.5)",transition:"opacity 0.3s ease-in-out"},tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content border-0 shadow-lg rounded-4 animate__animated animate__fadeInDown",children:[e.jsxs("div",{className:"modal-header bg-danger text-white rounded-top-4",children:[e.jsxs("h5",{className:"modal-title d-flex align-items-center gap-2",children:[e.jsx(ve,{}),"Confirm Deletion"]}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:B})]}),e.jsx("div",{className:"modal-body text-center",children:e.jsxs("p",{className:"fs-5 mb-0",children:["Are you sure you want to delete"," ",e.jsx("strong",{children:f==null?void 0:f.name}),"?"]})}),e.jsxs("div",{className:"modal-footer justify-content-center border-0 pb-4",children:[e.jsxs("button",{type:"button",className:"btn btn-secondary rounded text-white px-4 d-flex align-items-center gap-2",onClick:B,children:[e.jsx(be,{}),"Cancel"]}),e.jsxs("button",{type:"button",className:"btn btn-danger text-white rounded px-4 shadow d-flex align-items-center gap-2",onClick:ne,children:[e.jsx(ye,{}),"Yes, Delete"]})]})]})})}),J?e.jsxs("div",{className:"d-flex justify-content-center",style:{marginTop:"20%"},children:[e.jsx(b,{animation:"grow",variant:"secondary",size:"sm"}),e.jsx(b,{animation:"grow",variant:"warning"}),e.jsx(b,{animation:"grow",variant:"secondary",size:"sm"}),e.jsx(b,{animation:"grow",variant:"warning"})]}):e.jsx("div",{className:"d-flex",children:e.jsx("div",{className:"p-3",style:{width:"100vw"},children:e.jsx(fe,{className:"DataTable",columns:ce,data:I.filterItems(W,X,H),pagination:!0,paginationPerPage:I.paginationPerPage,paginationRowsPerPageOptions:I.paginationRowsPerPageOptions,progressPending:U,subHeader:!0,fixedHeaderScrollHeight:"400px",subHeaderComponent:de,persistTableHead:!0})})}),e.jsxs(c,{show:Z,onHide:M,placement:"end",backdrop:"false",style:{"--bs-offcanvas-width":"800px"},children:[e.jsx(c.Header,{closeButton:!0,children:e.jsx("div",{className:"w-100 text-center",children:e.jsx(c.Title,{style:{fontSize:"30px",fontWeight:600},children:G?"Edit Group":"Add Group"})})}),e.jsx(c.Body,{style:{marginTop:"-2vh"},children:e.jsxs(d,{className:"h-90",onSubmit:me,children:[e.jsxs(m,{className:"mb-4",children:[e.jsx(m.Text,{children:e.jsx(ge,{size:25,color:"#ffc800"})}),e.jsx(d.Control,{name:"itemGroupName",value:i.itemGroupName,onChange:t=>E("itemGroupName",t.target.value.replace(/[^a-zA-Z ]/g,"")),placeholder:"Group name",isInvalid:!!p.itemGroupName,isValid:i.itemGroupName&&!p.itemGroupName}),p.itemGroupName&&e.jsx("span",{className:"error-msg",children:p.itemGroupName})]}),e.jsxs(m,{className:"mb-3",children:[e.jsx(m.Text,{children:e.jsx(Ce,{size:25,color:"#ffc800"})}),e.jsxs(d.Select,{name:"itemGroupCode",value:i.itemGroupCode||"",onChange:t=>E("itemGroupCode",t.target.value),children:[e.jsx("option",{value:"",children:"Select group code"}),i.itemGroupCode&&!(u!=null&&u.some(t=>t.value===i.itemGroupCode))&&e.jsx("option",{value:i.itemGroupCode,children:i.itemGroupCode}),u==null?void 0:u.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),p.itemGroupCode&&e.jsx("span",{className:"error-msg",children:p.itemGroupCode})]}),e.jsxs(m,{className:"mb-3",children:[e.jsx(m.Text,{children:e.jsx(Ee,{size:25,color:"#ffc800"})}),e.jsx(d.Check,{type:"checkbox",label:"IsActive",checked:i.isActive,onChange:t=>E("isActive",t.target.checked),className:"ms-3"})]}),e.jsx("div",{className:"d-flex justify-content-center mt-4",children:e.jsx(g,{type:"submit",variant:"warning",children:G?"Update":"Save"})})]})})]}),e.jsxs(c,{show:Y,onHide:R,backdrop:"static",placement:"end",children:[e.jsx(c.Header,{closeButton:!0,children:e.jsx("div",{className:"w-100 text-center",children:e.jsx(c.Title,{style:{fontSize:"30px",fontWeight:600},children:"Add File"})})}),e.jsx(c.Body,{style:{marginTop:"-2vh"},children:e.jsxs(d,{className:"h-90",children:[e.jsxs(m,{className:"mb-3",children:[e.jsx(m.Text,{children:e.jsx(Ge,{size:25,color:"#ffc800"})}),e.jsx(d.Control,{type:"file",accept:".xlsx",name:"File",onChange:t=>{const s=t.target.files[0];se("File",s)}}),P.File&&e.jsx("span",{className:"error-msg",children:P.File})]}),e.jsx("div",{className:"d-flex justify-content-center mt-5",children:e.jsx(g,{type:"submit",variant:"warning",onClick:ue,children:"Save"})})]})})]})]})};export{We as default};
