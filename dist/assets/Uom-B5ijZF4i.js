import{r as o,u as xe,j as e,S as y,L as B}from"./index-BwjIhAk5.js";import{X as pe,D as I}from"./DataTableSettings-DsshIM33.js";import{l as fe,c as ge}from"./index-6cARXTD6.js";import{F as je,a as be,b as ve,d as ye,e as Ne}from"./index-BFbuKzBk.js";import{a as m}from"./AxiosInterceptor-C0G1OxbU.js";import{L as we,y as u}from"./index-DBZWtKGJ.js";import{G as Ce,O as l}from"./index-BZ-hmF14.js";import{a as Fe,b as Se}from"./index-DqFMOxbS.js";import{a as ke}from"./index-D0LwIwlf.js";import{F as r}from"./Form-Cyv1odcU.js";import{B as f}from"./Button-BDb3Qyxz.js";import{I as h}from"./InputGroup-B5T7iIyR.js";import"./iconBase-i6NgAem3.js";import"./index-BjX9kMhX.js";import"./Col-BeHysn_4.js";const Ge=()=>{var R;const g={uomId:"",uomName:"",isActive:!1},E={File:""},[c,x]=o.useState(g),[j,b]=o.useState({}),[A,D]=o.useState(E),[T,P]=o.useState({}),N=xe(),[n,V]=o.useState({});o.useEffect(()=>{var t;(t=N.state)!=null&&t.permissions&&V(N.state.permissions)},[(R=N.state)==null?void 0:R.permissions]);const z=o.useRef(!1),[_,Ie]=o.useState(!1),[O,G]=o.useState(""),[W,$]=o.useState([]),q=["uomName","uomQty","isActive"],[w,v]=o.useState(!1),[X,C]=o.useState(!1),[Z,U]=o.useState(!1),[Q,i]=o.useState(!1),H=()=>U(!1),Y=()=>U(!0),[J,F]=o.useState(!1),[p,S]=o.useState(null),L=()=>{C(!1),x(g),b({}),v(!1)},K=()=>{x(g),v(!1),b({}),C(!0)};o.useEffect(()=>{z.current||(z.current=!0,k())},[]);const ee=(t,a)=>{x(s=>({...s,[t]:a})),b(s=>({...s,[t]:""}))},te=(t,a)=>{D(s=>({...s,[t]:a})),P(s=>({...s,[t]:""}))},k=async()=>{var t,a;i(!0);try{const s=await m.get("/uom"),d=(a=(t=s==null?void 0:s.data)==null?void 0:t.list)==null?void 0:a.sort((ue,he)=>new Date(he.createdDate)-new Date(ue.createdDate));$(d)}catch(s){console.error("Error fetching table data",s)}finally{i(!1)}},se=async()=>{try{const t=await m.get("/uom/exportexcel",{responseType:"blob"}),a=new Blob([t.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),s=window.URL.createObjectURL(a),d=document.createElement("a");d.href=s,d.setAttribute("download","uom.xlsx"),document.body.appendChild(d),d.click(),d.remove(),window.URL.revokeObjectURL(s)}catch(t){console.error("Error downloading the file:",t),alert("Failed to export file.")}},ae=()=>{const{uomName:t}=c,a={};let s=!0;return t?/^[a-zA-Z ]+$/.test(t)||(a.uomName="Name must contain only letters",s=!1):(s=!1,a.uomName="Uom name is required."),b(a),s},oe=()=>{const{File:t}=A,a={};let s=!0;return t?t.type!=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&&(s=!1,a.File="Only .xlsx files are allowed."):(s=!1,a.File="Import file is required."),P(a),s},ne=t=>{v(!0),x({uomId:t.uomId,uomName:t.uomName,isActive:t.isActive}),C(!0)},re=(t,a)=>{S({id:t,name:a}),F(!0)},ie=()=>{p&&(i(!0),m.delete(`/uom/${p.id}`).then(t=>{u.success(t.data.successMessage||"Uom deleted successfully!"),k()}).catch(t=>{console.error("Error deleting uom:",t),u.error("Failed to delete uom.")}).finally(()=>{i(!1),F(!1),S(null)}))},M=()=>{F(!1),S(null)},le=[{name:e.jsx("h5",{children:"UOM Name"}),selector:t=>t.uomName,sortable:!0},{name:e.jsx("h5",{children:"Status"}),cell:t=>e.jsx("span",{style:{color:t.isActive?"#88E788":"#FF474C",fontWeight:"bold"},children:t.isActive?"Active":"Inactive"}),sortable:!0},{name:e.jsx("h5",{children:"Action"}),center:!0,cell:t=>e.jsxs(e.Fragment,{children:[(n==null?void 0:n.write)&&e.jsx(B,{className:"action-icon",onClick:()=>ne(t),children:e.jsx(Ne,{size:24,color:"#87CEEB"})}),(n==null?void 0:n.delete)&&e.jsx(B,{className:"action-icon",onClick:()=>re(t.uomId,t.uomName),children:e.jsx(ge,{size:30,style:{margin:"1vh"},color:"#FF474C"})})]})}],ce=o.useMemo(()=>e.jsxs("div",{className:"d-flex justify-content-end gap-2 align-items-center w-100",children:[e.jsx(r,{className:"d-flex",children:e.jsx(r.Control,{type:"search",placeholder:"Search...",className:"me-2 rounded-pill","aria-label":"Search",onChange:t=>G(t.target.value)})}),(n==null?void 0:n.import)&&e.jsxs(f,{variant:"info",onClick:Y,children:[e.jsx(Fe,{size:20})," Import"]}),(n==null?void 0:n.export)&&e.jsxs(f,{variant:"success",onClick:se,children:[e.jsx(Se,{size:20})," Export"]}),(n==null?void 0:n.write)&&e.jsxs(f,{variant:"warning",onClick:K,children:[e.jsx(Ce,{size:20})," Add"]})]}),[n,O]),de=async t=>{if(t.preventDefault(),!ae())return;const a={uomName:c.uomName,isActive:c.isActive};i(!0);try{let s;w?s=await m.put(`/uom/${c.uomId}`,a):s=await m.post("/uom",a),x(g),v(!1),L(),k(),u.success(s.data.successMessage||"Success!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch{u.error(res.data.ErrorMessage||"Something went wrong! Please try again.",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}finally{i(!1)}},me=async t=>{if(t.preventDefault(),!oe())return;const a=new FormData;a.append("File",A.File),i(!0);try{const s=await m.post("/uom/importexcel",a);u.success(s.data.successMessage||"File uploaded successfully!"),H(),D(E)}catch{u.error("Something went wrong! Please try again.")}finally{i(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(we,{}),J&&e.jsx("div",{className:"modal fade show",style:{display:"block",backgroundColor:"rgba(0, 0, 0, 0.5)",transition:"opacity 0.3s ease-in-out"},tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content border-0 shadow-lg rounded-4 animate__animated animate__fadeInDown",children:[e.jsxs("div",{className:"modal-header bg-danger text-white rounded-top-4",children:[e.jsxs("h5",{className:"modal-title d-flex align-items-center gap-2",children:[e.jsx(je,{}),"Confirm Deletion"]}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:M})]}),e.jsx("div",{className:"modal-body text-center",children:e.jsxs("p",{className:"fs-5 mb-0",children:["Are you sure you want to delete"," ",e.jsx("strong",{children:p==null?void 0:p.name}),"?"]})}),e.jsxs("div",{className:"modal-footer justify-content-center border-0 pb-4",children:[e.jsxs("button",{type:"button",className:"btn btn-secondary rounded text-white px-4 d-flex align-items-center gap-2",onClick:M,children:[e.jsx(be,{}),"Cancel"]}),e.jsxs("button",{type:"button",className:"btn btn-danger text-white rounded px-4 shadow d-flex align-items-center gap-2",onClick:ie,children:[e.jsx(ve,{}),"Yes, Delete"]})]})]})})}),Q?e.jsxs("div",{className:"d-flex justify-content-center",style:{marginTop:"20%"},children:[e.jsx(y,{animation:"grow",variant:"secondary",size:"sm"}),e.jsx(y,{animation:"grow",variant:"warning"}),e.jsx(y,{animation:"grow",variant:"secondary",size:"sm"}),e.jsx(y,{animation:"grow",variant:"warning"})]}):e.jsx("div",{className:"d-flex",children:e.jsx("div",{className:"p-3",style:{width:"100vw"},children:e.jsx("div",{style:{width:"100%"},children:e.jsx(pe,{columns:le,data:I.filterItems(W,q,O),pagination:!0,paginationPerPage:I.paginationPerPage,paginationRowsPerPageOptions:I.paginationRowsPerPageOptions,progressPending:_,subHeader:!0,fixedHeaderScrollHeight:"400px",subHeaderComponent:ce,persistTableHead:!0})})})}),e.jsxs(l,{show:X,onHide:L,placement:"end",backdrop:"false",style:{"--bs-offcanvas-width":"800px"},children:[e.jsx(l.Header,{closeButton:!0,children:e.jsx("div",{className:"w-100 text-center",children:e.jsx(l.Title,{style:{fontSize:"30px",fontWeight:600},children:w?"Edit Uom":"Add Uom"})})}),e.jsx(l.Body,{style:{marginTop:"-2vh"},children:e.jsxs(r,{className:"h-90",onSubmit:de,children:[e.jsxs(h,{className:"mb-4",children:[e.jsx(h.Text,{id:"uomName",children:e.jsx(fe,{size:25,color:"#ffc800"})}),e.jsx(r.Control,{name:"uomName",value:c.uomName||"",onChange:t=>ee("uomName",t.target.value.replace(/[^a-zA-Z ]/g,"")),placeholder:"Uom name","aria-label":"uomName",isInvalid:!!j.uomName,isValid:c.uomName&&!j.uomName}),j.uomName&&e.jsx("span",{className:"error-msg",children:j.uomName})]}),e.jsxs(h,{className:"mb-3",children:[e.jsx(h.Text,{id:"isActive",children:e.jsx(ke,{size:25,color:"#ffc800"})}),e.jsxs(r.Check,{type:"checkbox",id:"custom-checkbox",label:"IsActive",name:"isActive",className:"ms-3",style:{display:"flex",alignItems:"center",fontSize:"1rem"},custom:"true",children:[e.jsx(r.Check.Input,{type:"checkbox",checked:c.isActive,style:{width:"20px",height:"20px",cursor:"pointer",marginRight:"8px"}}),e.jsx(r.Check.Label,{htmlFor:"custom-checkbox",children:"IsActive"})]})]}),e.jsx("div",{className:"d-flex justify-content-center mt-4",children:e.jsx(f,{type:"submit",variant:"warning",children:w?"Update":"Save"})})]})})]}),e.jsxs(l,{show:Z,onHide:H,backdrop:"static",placement:"end",children:[e.jsx(l.Header,{closeButton:!0,children:e.jsx("div",{className:"w-100 text-center",children:e.jsx(l.Title,{style:{fontSize:"30px",fontWeight:600},children:"Add File"})})}),e.jsx(l.Body,{style:{marginTop:"-2vh"},children:e.jsxs(r,{className:"h-90",children:[e.jsxs(h,{className:"mb-3",children:[e.jsx(h.Text,{children:e.jsx(ye,{size:25,color:"#ffc800"})}),e.jsx(r.Control,{type:"file",accept:".xlsx",name:"File",onChange:t=>{const a=t.target.files[0];te("File",a)}}),T.File&&e.jsx("span",{className:"error-msg",children:T.File})]}),e.jsx("div",{className:"d-flex justify-content-center mt-5",children:e.jsx(f,{type:"submit",variant:"warning",onClick:me,children:"Save"})})]})})]})]})};export{Ge as default};
