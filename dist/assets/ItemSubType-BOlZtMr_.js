import{u as xe,r as s,j as e,S as I,L as X}from"./index-BwjIhAk5.js";import{X as fe,D as G}from"./DataTableSettings-DsshIM33.js";import{c as je}from"./index-6cARXTD6.js";import{F as ve,a as Ne,b as Ie,d as we,e as Fe}from"./index-BFbuKzBk.js";import{a as g}from"./AxiosInterceptor-C0G1OxbU.js";import{L as ke,y as S}from"./index-DBZWtKGJ.js";import{a as Te}from"./index-CYpNFU1B.js";import{g as De}from"./index-Dirjr-2I.js";import{G as Ee}from"./iconBase-i6NgAem3.js";import{a as Ge,b as ze,c as Ae}from"./index-DqFMOxbS.js";import{G as Pe,O as h}from"./index-BZ-hmF14.js";import{a as He}from"./index-D0LwIwlf.js";import{F as c}from"./Form-Cyv1odcU.js";import{B as f}from"./Button-BDb3Qyxz.js";import{I as l}from"./InputGroup-B5T7iIyR.js";import"./index-BjX9kMhX.js";import"./Col-BeHysn_4.js";function $(y){return Ee({attr:{version:"1.1",viewBox:"0 0 17 17"},child:[{tag:"g",attr:{},child:[]},{tag:"path",attr:{d:"M0.026 1h3v1h-2v13h2v1h-3v-15zM14.026 1v1h2v13h-2v1h3v-15h-3zM8.91 7.967c-1.115-0.433-1.607-0.804-1.607-1.56 0-0.552 0.42-1.211 1.523-1.211 0.731 0 1.271 0.239 1.535 0.384l0.288-0.852c-0.359-0.204-0.96-0.396-1.787-0.396-1.571 0-2.614 0.936-2.614 2.195 0 1.14 0.815 1.823 2.135 2.291 1.091 0.419 1.523 0.851 1.523 1.606 0 0.815-0.624 1.38-1.691 1.38-0.72 0-1.403-0.24-1.871-0.528l-0.264 0.876c0.432 0.287 1.283 0.516 2.062 0.516 1.907 0 2.831-1.079 2.831-2.327 0.001-1.188-0.696-1.847-2.063-2.374z"},child:[]}]})(y)}const et=()=>{var W;const y=xe(),[n,Y]=s.useState({});s.useEffect(()=>{var t;(t=y.state)!=null&&t.permissions&&Y(y.state.permissions)},[(W=y.state)==null?void 0:W.permissions]);const j={itemSubCategoryID:"",itemSubCategoryName:"",itemSubCategoryCode:"",itemSubCategoryShortCode:"",itemSubGroupShortCode:"",itemCategoryId:"",itemSubCategoryImage:"",isActive:!1},z={File:""},[r,p]=s.useState(j),[i,v]=s.useState({}),[A,P]=s.useState(z),[H,V]=s.useState({}),L=s.useRef(!1),[Z,J]=s.useState(!1),[O,K]=s.useState(""),[Q,ee]=s.useState([]),[w,te]=s.useState([]),[B,N]=s.useState(!1),[ae,F]=s.useState(!1),oe=["itemSubCategoryName","itemCategoryName","itemSubCategoryCode","itemSubCategoryShortCode"],[re,k]=s.useState(!1),[x,T]=s.useState(null),[se,M]=s.useState(!1),[ie,d]=s.useState(!1),R=()=>M(!1),ne=()=>M(!0);s.useEffect(()=>{L.current||(L.current=!0,D())},[]);const q=()=>{F(!1),p(j),v({}),N(!1)},le=()=>{p(j),N(!1),v({}),F(!0),U()},D=async()=>{var t,o;d(!0);try{const a=await g.get("/itemsubcategory"),m=(o=(t=a==null?void 0:a.data)==null?void 0:t.list)==null?void 0:o.sort((E,u)=>new Date(u.createdDate)-new Date(E.createdDate));ee(m)}catch(a){console.error("Error fetching table data",a),J(!1)}finally{d(!1)}},U=async()=>{d(!0);try{const t=await g.get("/itemcategory");te(t.data.list)}catch(t){console.error("Error fetching table data",t)}finally{d(!1)}},ce=async()=>{try{const t=await g.get("/itemsubcategory/exportexcel",{responseType:"blob"}),o=new Blob([t.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.URL.createObjectURL(o),m=document.createElement("a");m.href=a,m.setAttribute("download","itemSubCategory.xlsx"),document.body.appendChild(m),m.click(),m.remove(),window.URL.revokeObjectURL(a)}catch(t){console.error("Error downloading the file:",t),alert("Failed to export file.")}},C=(t,o)=>{p(a=>({...a,[t]:o})),v(a=>({...a,[t]:""}))},de=(t,o)=>{P(a=>({...a,[t]:o})),V(a=>({...a,[t]:""}))},me=t=>{N(!0),U(),p({itemSubCategoryID:t.itemSubCategoryID,itemSubCategoryName:t.itemSubCategoryName,itemSubCategoryCode:t.itemSubCategoryCode,itemSubCategoryShortCode:t.itemSubCategoryShortCode,itemSubGroupShortCode:t.itemSubGroupShortCode,itemCategoryId:t.itemCategoryId,isActive:t.isActive}),F(!0)},ue=(t,o)=>{T({id:t,name:o}),k(!0)},he=()=>{x&&(d(!0),g.delete(`/itemsubcategory/${x.id}`).then(t=>{S.success(t.data.successMessage||"Group deleted successfully!"),D()}).catch(t=>{console.error("Error deleting group:",t),S.error("Failed to delete group.")}).finally(()=>{d(!1),k(!1),T(null)}))},_=()=>{k(!1),T(null)},ge=[{name:e.jsx("h5",{children:"Sub Category Name"}),selector:t=>t.itemSubCategoryName,sortable:!0},{name:e.jsx("h5",{children:"Category Name"}),selector:t=>t.itemCategoryName,sortable:!0},{name:e.jsx("h5",{children:"Sub Category Code"}),selector:t=>t.itemSubCategoryCode,sortable:!0},{name:e.jsx("h5",{children:" Short Code"}),selector:t=>t.itemSubCategoryShortCode,sortable:!0},{name:e.jsx("h5",{children:"Status"}),cell:t=>e.jsx("span",{style:{color:t.isActive?"#88E788":"#FF474C",fontWeight:"bold"},children:t.isActive?"Active":"Inactive"}),sortable:!0},{name:e.jsx("h5",{style:{fontSize:"0.9vw"},children:"Action"}),center:!0,cell:t=>e.jsxs(e.Fragment,{children:[(n==null?void 0:n.write)&&e.jsx(X,{className:"action-icon",onClick:()=>me(t),children:e.jsx(Fe,{size:24,color:"#87CEEB"})}),(n==null?void 0:n.delete)&&e.jsx(X,{className:"action-icon",onClick:()=>ue(t.itemSubCategoryID,t.itemSubCategoryName),children:e.jsx(je,{size:30,style:{margin:"1vh"},color:"#FF474C"})})]})}],Ce=s.useMemo(()=>e.jsxs("div",{className:"d-flex justify-content-end gap-2 align-items-center w-100",children:[e.jsx(c,{className:"d-flex",children:e.jsx(c.Control,{type:"search",placeholder:"Search...",className:"me-2 rounded-pill","aria-label":"Search",onChange:t=>K(t.target.value)})}),(n==null?void 0:n.import)&&e.jsxs(f,{variant:"info",onClick:ne,children:[e.jsx(Ge,{size:20})," Import"]}),(n==null?void 0:n.export)&&e.jsxs(f,{variant:"success",onClick:ce,children:[e.jsx(ze,{size:20})," Export"]}),(n==null?void 0:n.write)&&e.jsxs(f,{variant:"warning",onClick:le,children:[e.jsx(Pe,{size:20})," Add"]})]}),[n,O]),be=()=>{const{itemSubCategoryName:t,itemSubCategoryCode:o,itemSubCategoryShortCode:a,itemSubGroupShortCode:m,itemCategoryId:E}=r,u={};let b=!0;return t||(b=!1,u.itemSubCategoryName="Sub category name is required."),o||(b=!1,u.itemSubCategoryCode="Sub category code is required."),a||(b=!1,u.itemSubCategoryShortCode="Sub category short code is required."),m||(b=!1,u.itemSubGroupShortCode="Sub group short code is required."),E||(b=!1,u.itemCategoryId="Category name is required."),v(u),b},Se=()=>{const{File:t}=A,o={};let a=!0;return t?t.type!=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&&(a=!1,o.File="Only .xlsx files are allowed."):(a=!1,o.File="Import file is required."),V(o),a},ye=async t=>{if(t.preventDefault(),!be())return;d(!0);const o={itemSubCategoryName:r.itemSubCategoryName,itemSubCategoryCode:r.itemSubCategoryCode,itemSubCategoryShortCode:r.itemSubCategoryShortCode,itemSubGroupShortCode:r.itemSubGroupShortCode,itemCategoryId:r.itemCategoryId,outletId,isActive:r.isActive};try{let a;r.itemSubCategoryID?a=await g.put(`/itemsubcategory/${r.itemSubCategoryID}`,o):a=await g.post("/itemsubcategory",o),p(j),N(!1),q(),D(),S.success(a.data.successMessage||"Success!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch(a){console.error("API Error:",a),S.error("Something went wrong! Please try again.",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}finally{d(!1)}},pe=async t=>{if(t.preventDefault(),!Se())return;const o=new FormData;o.append("File",A.File),d(!0);try{const a=await g.post("/itemsubcategory/importexcel",o);S.success(a.data.successMessage||"File uploaded successfully!"),R(),P(z)}catch{S.error("Something went wrong! Please try again.")}finally{d(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(ke,{}),re&&e.jsx("div",{className:"modal fade show",style:{display:"block",backgroundColor:"rgba(0, 0, 0, 0.5)",transition:"opacity 0.3s ease-in-out"},tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content border-0 shadow-lg rounded-4 animate__animated animate__fadeInDown",children:[e.jsxs("div",{className:"modal-header bg-danger text-white rounded-top-4",children:[e.jsxs("h5",{className:"modal-title d-flex align-items-center gap-2",children:[e.jsx(ve,{}),"Confirm Deletion"]}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:_})]}),e.jsx("div",{className:"modal-body text-center",children:e.jsxs("p",{className:"fs-5 mb-0",children:["Are you sure you want to delete"," ",e.jsx("strong",{children:x==null?void 0:x.name}),"?"]})}),e.jsxs("div",{className:"modal-footer justify-content-center border-0 pb-4",children:[e.jsxs("button",{type:"button",className:"btn btn-secondary rounded text-white px-4 d-flex align-items-center gap-2",onClick:_,children:[e.jsx(Ne,{}),"Cancel"]}),e.jsxs("button",{type:"button",className:"btn btn-danger text-white rounded px-4 shadow d-flex align-items-center gap-2",onClick:he,children:[e.jsx(Ie,{}),"Yes, Delete"]})]})]})})}),ie?e.jsxs("div",{className:"d-flex justify-content-center",style:{marginTop:"20%"},children:[e.jsx(I,{animation:"grow",variant:"secondary",size:"sm"}),e.jsx(I,{animation:"grow",variant:"warning"}),e.jsx(I,{animation:"grow",variant:"secondary",size:"sm"}),e.jsx(I,{animation:"grow",variant:"warning"})]}):e.jsx("div",{className:"d-flex",children:e.jsx("div",{className:"p-4",style:{width:"100vw"},children:e.jsx("div",{className:"",style:{width:"100%"},children:e.jsx(fe,{columns:ge,data:G.filterItems(Q,oe,O),pagination:!0,paginationPerPage:G.paginationPerPage,paginationRowsPerPageOptions:G.paginationRowsPerPageOptions,progressPending:Z,subHeader:!0,fixedHeaderScrollHeight:"400px",subHeaderComponent:Ce,persistTableHead:!0})})})}),e.jsxs(h,{show:ae,onHide:q,placement:"end",backdrop:"false",style:{"--bs-offcanvas-width":"800px"},children:[e.jsx(h.Header,{closeButton:!0,children:e.jsx("div",{className:"w-100 text-center",children:e.jsx(h.Title,{style:{fontSize:"25px",fontWeight:600},children:B?"Edit Item Sub Category":"Add Item Sub Category"})})}),e.jsx(h.Body,{style:{marginTop:"-2vh"},children:e.jsxs(c,{className:"h-100",onSubmit:ye,children:[e.jsxs(l,{className:"mb-4",children:[e.jsx(l.Text,{id:"itemSubCategoryName",children:e.jsx(Te,{size:25,color:"#ffc800"})}),e.jsx(c.Control,{name:"itemSubCategoryName",value:r.itemSubCategoryName||"",onChange:t=>C("itemSubCategoryName",t.target.value.replace(/[^a-zA-Z ]/g,"")),placeholder:"Sub category name","aria-label":"itemSubCategoryName",isInvalid:!!i.itemSubCategoryName,isValid:r.itemSubCategoryName&&!i.itemSubCategoryName}),i.itemSubCategoryName&&e.jsx("span",{className:"error-msg",children:i.itemSubCategoryName})]}),e.jsxs(l,{className:"mb-4",children:[e.jsx(l.Text,{id:"itemSubCategoryCode",children:e.jsx(De,{size:25,color:"#ffc800"})}),e.jsx(c.Control,{name:"itemSubCategoryCode",value:r.itemSubCategoryCode||"",onChange:t=>C("itemSubCategoryCode",t.target.value),placeholder:"Sub category code","aria-label":"itemSubCategoryCode",isInvalid:!!i.itemSubCategoryCode,isValid:r.itemSubCategoryCode&&!i.itemSubCategoryCode}),i.itemSubCategoryCode&&e.jsx("span",{className:"error-msg",children:i.itemSubCategoryCode})]}),e.jsxs(l,{className:"mb-4",children:[e.jsx(l.Text,{id:"itemSubCategoryShortCode",children:e.jsx($,{size:25,color:"#ffc800"})}),e.jsx(c.Control,{name:"itemSubCategoryShortCode",value:r.itemSubCategoryShortCode||"",onChange:t=>C("itemSubCategoryShortCode",t.target.value),placeholder:"Sub category short code","aria-label":"itemSubCategoryShortCode",isInvalid:!!i.itemSubCategoryShortCode,isValid:r.itemSubCategoryShortCode&&!i.itemSubCategoryShortCode}),i.itemSubCategoryShortCode&&e.jsx("span",{className:"error-msg",children:i.itemSubCategoryShortCode})]}),e.jsxs(l,{className:"mb-4",children:[e.jsx(l.Text,{id:"itemSubGroupShortCode",children:e.jsx($,{size:25,color:"#ffc800"})}),e.jsx(c.Control,{name:"itemSubGroupShortCode",value:r.itemSubGroupShortCode||"",onChange:t=>C("itemSubGroupShortCode",t.target.value),placeholder:"Sub group short code","aria-label":"itemSubGroupShortCode",isInvalid:!!i.itemSubGroupShortCode,isValid:r.itemSubGroupShortCode&&!i.itemSubGroupShortCode}),i.itemSubGroupShortCode&&e.jsx("span",{className:"error-msg",children:i.itemSubGroupShortCode})]}),e.jsxs(l,{className:"mb-3",children:[e.jsx(l.Text,{id:"itemCategoryId",children:e.jsx(Ae,{size:25,color:"#ffc800"})}),e.jsxs(c.Select,{name:"itemCategoryId",value:r.itemCategoryId||"",onChange:t=>C("itemCategoryId",t.target.value),children:[e.jsx("option",{children:"Select category name"}),w==null?void 0:w.map(t=>e.jsx("option",{value:t.itemGroupId,children:t.itemCategoryName},t.itemGroupId))]}),i.itemCategoryId&&e.jsx("span",{className:"error-msg",children:i.itemCategoryId})]}),e.jsxs(l,{className:"mb-3",children:[e.jsx(l.Text,{id:"isActive",children:e.jsx(He,{size:25,color:"#ffc800"})}),e.jsxs(c.Check,{type:"checkbox",id:"custom-checkbox",label:"IsActive",name:"isActive",className:"ms-3",style:{display:"flex",alignItems:"center",fontSize:"1rem"},custom:"true",children:[e.jsx(c.Check.Input,{type:"checkbox",checked:r.isActive,onChange:t=>C("isActive",t.target.checked),style:{width:"20px",height:"20px",cursor:"pointer",marginRight:"8px"}}),e.jsx(c.Check.Label,{htmlFor:"custom-checkbox",children:"IsActive"})]})]}),e.jsx("div",{className:"d-flex justify-content-center mt-5",children:e.jsx(f,{type:"submit",variant:"warning",children:B?"Update":"Submit"})})]})})]}),e.jsxs(h,{show:se,onHide:R,backdrop:"static",placement:"end",children:[e.jsx(h.Header,{closeButton:!0,children:e.jsx("div",{className:"w-100 text-center",children:e.jsx(h.Title,{style:{fontSize:"30px",fontWeight:600},children:"Add File"})})}),e.jsx(h.Body,{style:{marginTop:"-2vh"},children:e.jsxs(c,{className:"h-90",children:[e.jsxs(l,{className:"mb-3",children:[e.jsx(l.Text,{children:e.jsx(we,{size:25,color:"#ffc800"})}),e.jsx(c.Control,{type:"file",accept:".xlsx",name:"File",onChange:t=>{const o=t.target.files[0];de("File",o)}}),H.File&&e.jsx("span",{className:"error-msg",children:H.File})]}),e.jsx("div",{className:"d-flex justify-content-center mt-5",children:e.jsx(f,{type:"submit",variant:"warning",onClick:pe,children:"Save"})})]})})]})]})};export{et as default};
