import{r as n,u as ve,j as e,S as h,L as _}from"./index-BwjIhAk5.js";import{X as ye,D as E}from"./DataTableSettings-DsshIM33.js";import{l as be,c as Ce}from"./index-6cARXTD6.js";import{F as we,a as Ie,b as Fe,i as $,d as Ne,e as Se}from"./index-BFbuKzBk.js";import{a as j,b as Ue}from"./AxiosInterceptor-C0G1OxbU.js";import{L as ke,y as p}from"./index-DBZWtKGJ.js";import{G as Ee,O as x}from"./index-BZ-hmF14.js";import{a as Te,b as Ae}from"./index-DqFMOxbS.js";import{a as ze}from"./index-D0LwIwlf.js";import{b as G}from"./index-D8B2cRTV.js";import{F as l}from"./Form-Cyv1odcU.js";import{B as y}from"./Button-BDb3Qyxz.js";import{I as i}from"./InputGroup-B5T7iIyR.js";import"./iconBase-i6NgAem3.js";import"./index-BjX9kMhX.js";import"./Col-BeHysn_4.js";const Ze=()=>{var W;const b={id:"",name:"",fromUomId:"",toUomId:"",multiplier:"",addFraction:"",isActive:!1},X=localStorage.getItem("accessToken"),T={File:""},[o,c]=n.useState(b),[f,w]=n.useState({}),[A,z]=n.useState(T),[D,O]=n.useState({}),I=ve(),[r,Q]=n.useState({});n.useEffect(()=>{var t;(t=I.state)!=null&&t.permissions&&Q(I.state.permissions)},[(W=I.state)==null?void 0:W.permissions]);const P=n.useRef(!1),[Y,De]=n.useState(!1),[H,Z]=n.useState(""),[J,K]=n.useState([]),ee=["name","uomQty","isActive"],[F,C]=n.useState(!1),[te,N]=n.useState(!1),[se,L]=n.useState(!1),[M,d]=n.useState(!1),B=()=>L(!1),ae=()=>L(!0),[oe,S]=n.useState(!1),[v,U]=n.useState(null),[g,ne]=n.useState([]),R=()=>{N(!1),c(b),w({}),C(!1)},re=()=>{c(b),C(!1),w({}),N(!0),V()};n.useEffect(()=>{P.current||(P.current=!0,k())},[]);const ie=(t,s)=>{z(a=>({...a,[t]:s})),O(a=>({...a,[t]:""}))},V=async()=>{var t;d(!0);try{const s=await j.get("/uom");ne((t=s==null?void 0:s.data)==null?void 0:t.list)}catch(s){console.error("Error fetching table data",s)}finally{d(!1)}},k=async()=>{var t,s;d(!0);try{const a=await j.get("/uomconversion"),m=(s=(t=a==null?void 0:a.data)==null?void 0:t.list)==null?void 0:s.sort((u,je)=>new Date(je.createdDate)-new Date(u.createdDate));K(m)}catch(a){console.error("Error fetching table data",a)}finally{d(!1)}},le=async()=>{try{const t=await Ue.get("https://hotel-api-newdev-hvbbe9bwe3gxemd6.eastasia-01.azurewebsites.net/api/v1/uom/exportexcel",{responseType:"blob",headers:{Authorization:`Bearer ${X}`}}),s=new Blob([t.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.URL.createObjectURL(s),m=document.createElement("a");m.href=a,m.setAttribute("download","uom.xlsx"),document.body.appendChild(m),m.click(),m.remove(),window.URL.revokeObjectURL(a)}catch(t){console.error("Error downloading the file:",t),alert("Failed to export file.")}},ce=()=>{const{name:t}=o,s={};let a=!0;return t?/^[a-zA-Z ]+$/.test(t)||(s.name="Name must contain only letters",a=!1):(a=!1,s.name="Uom name is required."),w(s),a},de=()=>{const{File:t}=A,s={};let a=!0;return t?t.type!=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&&(a=!1,s.File="Only .xlsx files are allowed."):(a=!1,s.File="Import file is required."),O(s),a},me=t=>{C(!0),c({id:t.id,name:t.name,fromUomId:t.fromUomId,toUomId:t.toUomId,multiplier:t.multiplier,addFraction:t.addFraction,isActive:t.isActive}),N(!0),V()},ue=(t,s)=>{U({id:t,name:s}),S(!0)},he=()=>{v&&(d(!0),j.delete(`/uomconversion/${v.id}`).then(t=>{p.success(t.data.successMessage||"Uom deleted successfully!"),k()}).catch(t=>{console.error("Error deleting uom:",t),p.error("Failed to delete uom.")}).finally(()=>{d(!1),S(!1),U(null)}))},q=()=>{S(!1),U(null)},xe=[{name:e.jsx("h5",{children:"Name"}),selector:t=>t.name,sortable:!0},{name:e.jsx("h5",{children:"Status"}),cell:t=>e.jsx("span",{style:{color:t.isActive?"#88E788":"#FF474C",fontWeight:"bold"},children:t.isActive?"Active":"Inactive"}),sortable:!0},{name:e.jsx("h5",{children:"Action"}),center:!0,cell:t=>e.jsxs(e.Fragment,{children:[(r==null?void 0:r.write)&&e.jsx(_,{className:"action-icon",onClick:()=>me(t),children:e.jsx(Se,{size:24,color:"#87CEEB"})}),(r==null?void 0:r.delete)&&e.jsx(_,{className:"action-icon",onClick:()=>ue(t.id,t.name),children:e.jsx(Ce,{size:30,style:{margin:"1vh"},color:"#FF474C"})})]})}],pe=n.useMemo(()=>e.jsxs("div",{className:"d-flex justify-content-end gap-2 align-items-center w-100",children:[e.jsx(l,{className:"d-flex",children:e.jsx(l.Control,{type:"search",placeholder:"Search...",className:"me-2 rounded-pill","aria-label":"Search",onChange:t=>Z(t.target.value)})}),(r==null?void 0:r.import)&&e.jsxs(y,{variant:"info",onClick:ae,children:[e.jsx(Te,{size:20})," Import"]}),(r==null?void 0:r.export)&&e.jsxs(y,{variant:"success",onClick:le,children:[e.jsx(Ae,{size:20})," Export"]}),(r==null?void 0:r.write)&&e.jsxs(y,{variant:"warning",onClick:re,children:[e.jsx(Ee,{size:20})," Add"]})]}),[r,H]),fe=async t=>{var a,m;if(t.preventDefault(),!ce())return;if(o.fromUomId===o.toUomId){p.error("From UOM and To UOM cannot be the same.",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0});return}const s={name:o.name,fromUomId:o.fromUomId,toUomId:o.toUomId,multiplier:o.multiplier,addFraction:o.addFraction,isActive:o.isActive};d(!0);try{let u;F?u=await j.put(`/uomconversion/${o.id}`,s):u=await j.post("/uomconversion",s),c(b),C(!1),R(),k(),p.success(u.data.successMessage||"Success!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch(u){p.error(((m=(a=u==null?void 0:u.response)==null?void 0:a.data)==null?void 0:m.ErrorMessage)||"Something went wrong! Please try again.",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}finally{d(!1)}},ge=async t=>{if(t.preventDefault(),!de())return;const s=new FormData;s.append("File",A.File),d(!0);try{const a=await j.post("/uomconversion/importexcel",s);p.success(a.data.successMessage||"File uploaded successfully!"),B(),z(T)}catch{p.error("Something went wrong! Please try again.")}finally{d(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(ke,{}),oe&&e.jsx("div",{className:"modal fade show",style:{display:"block",backgroundColor:"rgba(0, 0, 0, 0.5)",transition:"opacity 0.3s ease-in-out"},tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content border-0 shadow-lg rounded-4 animate__animated animate__fadeInDown",children:[e.jsxs("div",{className:"modal-header bg-danger text-white rounded-top-4",children:[e.jsxs("h5",{className:"modal-title d-flex align-items-center gap-2",children:[e.jsx(we,{}),"Confirm Deletion"]}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:q})]}),e.jsx("div",{className:"modal-body text-center",children:e.jsxs("p",{className:"fs-5 mb-0",children:["Are you sure you want to delete"," ",e.jsx("strong",{children:v==null?void 0:v.name}),"?"]})}),e.jsxs("div",{className:"modal-footer justify-content-center border-0 pb-4",children:[e.jsxs("button",{type:"button",className:"btn btn-secondary rounded text-white px-4 d-flex align-items-center gap-2",onClick:q,children:[e.jsx(Ie,{}),"Cancel"]}),e.jsxs("button",{type:"button",className:"btn btn-danger text-white rounded px-4 shadow d-flex align-items-center gap-2",onClick:he,children:[e.jsx(Fe,{}),"Yes, Delete"]})]})]})})}),M?e.jsxs("div",{className:"d-flex justify-content-center",style:{marginTop:"20%"},children:[e.jsx(h,{animation:"grow",variant:"secondary",size:"sm"}),e.jsx(h,{animation:"grow",variant:"warning"}),e.jsx(h,{animation:"grow",variant:"secondary",size:"sm"}),e.jsx(h,{animation:"grow",variant:"warning"})]}):e.jsx("div",{className:"d-flex",children:e.jsx("div",{className:"p-3",style:{width:"100vw"},children:e.jsx("div",{style:{width:"100%"},children:e.jsx(ye,{columns:xe,data:E.filterItems(J,ee,H),pagination:!0,paginationPerPage:E.paginationPerPage,paginationRowsPerPageOptions:E.paginationRowsPerPageOptions,progressPending:Y,subHeader:!0,fixedHeaderScrollHeight:"400px",subHeaderComponent:pe,persistTableHead:!0})})})}),e.jsxs(x,{show:te,onHide:R,placement:"end",backdrop:"false",className:"custom-offcanvasConversion",children:[e.jsx(x.Header,{closeButton:!0,children:e.jsx("div",{className:"w-100 text-center",children:e.jsx(x.Title,{style:{fontSize:"30px",fontWeight:600},children:F?"Edit Uom Conversion":"Add Uom Convertion"})})}),e.jsx(x.Body,{style:{marginTop:"-2vh"},children:M?e.jsxs("div",{className:"d-flex justify-content-center",style:{marginTop:"20%"},children:[e.jsx(h,{animation:"grow",variant:"secondary",size:"sm"}),e.jsx(h,{animation:"grow",variant:"warning"}),e.jsx(h,{animation:"grow",variant:"secondary",size:"sm"}),e.jsx(h,{animation:"grow",variant:"warning"})]}):e.jsxs(l,{className:"h-90",onSubmit:fe,children:[e.jsxs(i,{className:"mb-4",children:[e.jsx(i.Text,{id:"Uom Conversion name",children:e.jsx(be,{size:25,color:"#ffc800"})}),e.jsx(l.Control,{name:"Uom Conversion name",value:o.name||"",onChange:t=>c({...o,name:t.target.value}),placeholder:"Uom Conversion name","aria-label":"Uom Conversion name",isInvalid:!!f.name,isValid:o.name&&!f.name}),f.uomName&&e.jsx("span",{className:"error-msg",children:f.uomName})]}),e.jsxs(i,{className:"mb-4",children:[e.jsx(i.Text,{id:"employeeTypeId",children:e.jsx(G,{size:25,color:"#ffc800"})}),e.jsxs(l.Select,{value:o.fromUomId,onChange:t=>c({...o,fromUomId:t.target.value}),required:!0,isInvalid:!!f.fromUomId,children:[e.jsx("option",{value:"",children:"Select Form Uom"}),g==null?void 0:g.map(t=>e.jsx("option",{value:t.uomId,children:t.uomName},t.uomId))]})]}),e.jsxs(i,{className:"mb-4",children:[e.jsx(i.Text,{id:"employeeTypeId",children:e.jsx(G,{size:25,color:"#ffc800"})}),e.jsxs(l.Select,{value:o.toUomId,onChange:t=>c({...o,toUomId:t.target.value}),required:!0,isInvalid:!!f.toUomId,children:[e.jsx("option",{value:"",children:"Select To Uom"}),g==null?void 0:g.map(t=>e.jsx("option",{value:t.uomId,children:t.uomName},t.uomId))]})]}),e.jsxs(i,{className:"mb-4",children:[e.jsx(i.Text,{id:"employeeTypeId",children:e.jsx($,{size:25,color:"#ffc800"})}),e.jsx(l.Control,{type:"number",placeholder:"Enter Multiplier Value",value:o.multiplier,onChange:t=>c({...o,multiplier:t.target.value})})]}),e.jsxs(i,{className:"mb-4",children:[e.jsx(i.Text,{id:"employeeTypeId",children:e.jsx($,{size:25,color:"#ffc800"})}),e.jsx(l.Control,{type:"number",placeholder:"Enter Fraction Value",value:o.addFraction,onChange:t=>c({...o,addFraction:t.target.value})})]}),e.jsxs(i,{className:"mb-3",children:[e.jsx(i.Text,{id:"isActive",children:e.jsx(ze,{size:25,color:"#ffc800"})}),e.jsxs(l.Check,{type:"checkbox",id:"custom-checkbox",label:"IsActive",name:"isActive",className:"ms-3",style:{display:"flex",alignItems:"center",fontSize:"1rem"},custom:"true",children:[e.jsx(l.Check.Input,{type:"checkbox",className:"custom-yellow-checkbox",onChange:t=>c({...o,isActive:t.target.checked}),checked:o.isActive,style:{width:"20px",height:"20px",cursor:"pointer",marginRight:"8px"}}),e.jsx(l.Check.Label,{htmlFor:"custom-checkbox",children:"IsActive"})]})]}),e.jsx("div",{className:"d-flex justify-content-center mt-4",children:e.jsx(y,{type:"submit",variant:"warning",children:F?"Update":"Save"})})]})})]}),e.jsxs(x,{show:se,onHide:B,backdrop:"static",placement:"end",children:[e.jsx(x.Header,{closeButton:!0,children:e.jsx("div",{className:"w-100 text-center",children:e.jsx(x.Title,{style:{fontSize:"30px",fontWeight:600},children:"Add File"})})}),e.jsx(x.Body,{style:{marginTop:"-2vh"},children:e.jsxs(l,{className:"h-90",children:[e.jsxs(i,{className:"mb-3",children:[e.jsx(i.Text,{children:e.jsx(Ne,{size:25,color:"#ffc800"})}),e.jsx(l.Control,{type:"file",accept:".xlsx",name:"File",onChange:t=>{const s=t.target.files[0];ie("File",s)}}),D.File&&e.jsx("span",{className:"error-msg",children:D.File})]}),e.jsx("div",{className:"d-flex justify-content-center mt-5",children:e.jsx(y,{type:"submit",variant:"warning",onClick:ge,children:"Save"})})]})})]})]})};export{Ze as default};
