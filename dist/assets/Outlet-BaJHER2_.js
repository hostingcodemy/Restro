import{r as o,u as K,j as e,L as T}from"./index-BwjIhAk5.js";import{X as Q,D as g}from"./DataTableSettings-DsshIM33.js";import{c as Y}from"./index-6cARXTD6.js";import{d as _,e as ee}from"./index-BFbuKzBk.js";import{a as p}from"./AxiosInterceptor-C0G1OxbU.js";import{L as te,y as x}from"./index-DBZWtKGJ.js";import{G as se,O as n}from"./index-BZ-hmF14.js";import{a as ae,b as oe}from"./index-DqFMOxbS.js";import{a as re}from"./index-D0LwIwlf.js";import{F as i}from"./Form-Cyv1odcU.js";import{B as d}from"./Button-BDb3Qyxz.js";import{I as c}from"./InputGroup-B5T7iIyR.js";import"./iconBase-i6NgAem3.js";import"./index-BjX9kMhX.js";import"./Col-BeHysn_4.js";const ye=()=>{var E;const u={outletName:"",outletCode:"",outletType:"",hsnCode:"",channelID:"",phone:"",mobile:"",email:""},[r,m]=o.useState(u),[h,j]=o.useState({}),f=K(),[s,I]=o.useState({});o.useEffect(()=>{var t;(t=f.state)!=null&&t.permissions&&I(f.state.permissions)},[(E=f.state)==null?void 0:E.permissions]);const v=o.useRef(!1),[O,P]=o.useState(!1),[C,k]=o.useState(""),[D,F]=o.useState([]),G=["outletName","outletCode","outletType","hsnCode"],[N,y]=o.useState(!1),[H,b]=o.useState(!1),[A,S]=o.useState(!1),[z,ne]=o.useState(!1),B=()=>S(!1),L=()=>S(!0),M=()=>{b(!1),m(u),j({}),y(!1)},R=()=>{m(u),y(!1),j({}),b(!0)};o.useEffect(()=>{v.current||(v.current=!0,w())},[]);const w=async()=>{var t,l;try{const a=await p.get("/outlets"),Z=(l=(t=a==null?void 0:a.data)==null?void 0:t.list)==null?void 0:l.sort((q,J)=>new Date(J.createdDate)-new Date(q.createdDate));F(Z)}catch(a){console.error("Error fetching table data",a),P(!1)}},V=t=>{m({OutletId:t.OutletId,outletName:t.outletName,outletCode:t.outletCode,outletType:t.outletType,hsnCode:t.hsnCode})},W=(t,l)=>{window.confirm(`Are you sure you want to delete the outlet "${l}"?`)&&p.delete(`/outlets/${t}`).then(a=>{x.success(a.data.successMessage||"Outlet deleted successfully!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),w()}).catch(a=>{console.error("Error deleting outlet:",a),x.error("Failed to delete outlet.",{position:"top-right",autoClose:3e3})})},$=[{name:e.jsx("h5",{children:"Outlet Name"}),selector:t=>t.outletName,sortable:!0},{name:e.jsx("h5",{children:"Email"}),selector:t=>t.email,sortable:!0},{name:e.jsx("h5",{children:"Phone"}),selector:t=>t.phone,sortable:!0},{name:e.jsx("h5",{children:"Channel Name"}),selector:t=>t.channelName,sortable:!0},{name:e.jsx("h5",{children:"Status"}),cell:t=>e.jsx("span",{style:{color:t.isActive?"#88E788":"#FF474C",fontWeight:"bold"},children:t.isActive?"Active":"Inactive"}),sortable:!0},{name:e.jsx("h5",{children:"Action"}),center:!0,cell:t=>e.jsxs(e.Fragment,{children:[(s==null?void 0:s.write)&&e.jsx(T,{className:"action-icon",onClick:()=>V(t),children:e.jsx(ee,{size:24,color:"#87CEEB"})}),(s==null?void 0:s.delete)&&e.jsx(T,{className:"action-icon",onClick:()=>W(t.outletID,t.outletName),children:e.jsx(Y,{size:30,style:{margin:"1vh"},color:"#FF474C"})})]})}],X=o.useMemo(()=>e.jsxs("div",{className:"d-flex justify-content-end gap-2 align-items-center w-100",children:[e.jsx(i,{className:"d-flex",children:e.jsx(i.Control,{type:"search",placeholder:"Search...",className:"me-2 rounded-pill","aria-label":"Search",onChange:t=>k(t.target.value)})}),(s==null?void 0:s.import)&&e.jsxs(d,{variant:"info",onClick:L,children:[e.jsx(ae,{size:20})," Import"]}),(s==null?void 0:s.export)&&e.jsxs(d,{variant:"success",children:[e.jsx(oe,{size:20})," Export"]}),(s==null?void 0:s.write)&&e.jsxs(d,{variant:"warning",onClick:R,children:[e.jsx(se,{size:20})," Add"]})]}),[s,C]),U=async t=>{if(t.preventDefault(),!validateForm())return;const l={outletName:r.outletName,outletCode:r.outletCode,outletType:r.outletType,hsnCode:r.hsnCode,channelID:"409967e4-2cf8-4bb3-989a-2bd2755ffce1"};try{let a;r.OutletId?a=await p.put(`/outlets/${r.OutletId}`,l):a=await p.post("/outlets",l),m(u),x.success(a.data.successMessage||"Success!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),setTimeout(()=>{navigate("/outlets")},3e3)}catch(a){console.error("API Error:",a),x.error("Something went wrong! Please try again.",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}};return e.jsxs(e.Fragment,{children:[e.jsx(te,{}),z?e.jsxs("div",{className:"d-flex justify-content-center",style:{marginTop:"20%"},children:[e.jsx(Spinner,{animation:"grow",variant:"secondary",size:"sm"}),e.jsx(Spinner,{animation:"grow",variant:"warning"}),e.jsx(Spinner,{animation:"grow",variant:"secondary",size:"sm"}),e.jsx(Spinner,{animation:"grow",variant:"warning"})]}):e.jsx("div",{className:"d-flex",children:e.jsx("div",{className:"p-3",style:{width:"100vw"},children:e.jsx(Q,{className:"DataTable",columns:$,data:g.filterItems(D,G,C),pagination:!0,paginationPerPage:g.paginationPerPage,paginationRowsPerPageOptions:g.paginationRowsPerPageOptions,progressPending:O,subHeader:!0,fixedHeaderScrollHeight:"400px",subHeaderComponent:X,persistTableHead:!0})})}),e.jsxs(n,{show:H,onHide:M,placement:"end",backdrop:"false",style:{"--bs-offcanvas-width":"800px"},children:[e.jsx(n.Header,{closeButton:!0,children:e.jsx("div",{className:"w-100 text-center",children:e.jsx(n.Title,{style:{fontSize:"30px",fontWeight:600},children:N?"Edit Group":"Add Group"})})}),e.jsx(n.Body,{style:{marginTop:"-2vh"},children:e.jsxs(i,{className:"h-90",onSubmit:U,children:[e.jsxs(c,{className:"mb-4",children:[e.jsx(c.Text,{}),e.jsx(i.Control,{name:"itemGroupName",value:r.itemGroupName,onChange:t=>handleChange("itemGroupName",t.target.value.replace(/[^a-zA-Z ]/g,"")),placeholder:"Group name",isInvalid:!!h.itemGroupName,isValid:r.itemGroupName&&!h.itemGroupName}),h.itemGroupName&&e.jsx("span",{className:"error-msg",children:h.itemGroupName})]}),e.jsxs(c,{className:"mb-3",children:[e.jsx(c.Text,{children:e.jsx(re,{size:25,color:"#ffc800"})}),e.jsx(i.Check,{type:"checkbox",label:"IsActive",checked:r.isActive,onChange:t=>handleChange("isActive",t.target.checked),className:"ms-3"})]}),e.jsx("div",{className:"d-flex justify-content-center mt-4",children:e.jsx(d,{type:"submit",variant:"warning",children:N?"Update":"Save"})})]})})]}),e.jsxs(n,{show:A,onHide:B,backdrop:"static",placement:"end",children:[e.jsx(n.Header,{closeButton:!0,children:e.jsx("div",{className:"w-100 text-center",children:e.jsx(n.Title,{style:{fontSize:"30px",fontWeight:600},children:"Add File"})})}),e.jsx(n.Body,{style:{marginTop:"-2vh"},children:e.jsxs(i,{className:"h-90",children:[e.jsxs(c,{className:"mb-3",children:[e.jsx(c.Text,{children:e.jsx(_,{size:25,color:"#ffc800"})}),e.jsx(i.Control,{type:"file"})]}),e.jsx("div",{className:"d-flex justify-content-center mt-5",children:e.jsx(d,{type:"submit",variant:"warning",children:"Save"})})]})})]})]})};export{ye as default};
