import{u as xe,r as o,j as e,S as T,L as U}from"./index-BwjIhAk5.js";import{X as ye,D as k}from"./DataTableSettings-DsshIM33.js";import{b as fe,c as ge}from"./index-6cARXTD6.js";import{F as je,a as Ne,b as Te,c as be,d as ve,e as Se}from"./index-BFbuKzBk.js";import{a as h}from"./AxiosInterceptor-C0G1OxbU.js";import{L as we,y as u}from"./index-DBZWtKGJ.js";import{G as Ce,O as p}from"./index-BZ-hmF14.js";import{a as Ee,b as Fe}from"./index-DqFMOxbS.js";import{a as ke}from"./index-D0LwIwlf.js";import{F as i}from"./Form-Cyv1odcU.js";import{B as f}from"./Button-BDb3Qyxz.js";import{I as d}from"./InputGroup-B5T7iIyR.js";import"./iconBase-i6NgAem3.js";import"./index-BjX9kMhX.js";import"./Col-BeHysn_4.js";const Ge=()=>{var V;const b=xe(),[r,_]=o.useState({});o.useEffect(()=>{var t;(t=b.state)!=null&&t.permissions&&_(b.state.permissions)},[(V=b.state)==null?void 0:V.permissions]);const I=o.useRef(!1),g={empTypeId:"",empTypeName:"",empTypeShortName:"",isActive:!1},A={File:""},[l,x]=o.useState(g),[c,j]=o.useState({}),[D,P]=o.useState(A),[z,O]=o.useState({}),[q,G]=o.useState(!1),[H,W]=o.useState(""),[$,X]=o.useState([]),Z=["empTypeName","empTypeShortName","isActive"],[v,N]=o.useState(!1),[Y,S]=o.useState(!1),[J,L]=o.useState(!1),[K,m]=o.useState(!1),B=()=>L(!1),Q=()=>L(!0),[ee,w]=o.useState(!1),[y,C]=o.useState(null),R=()=>{S(!1),x(g),j({}),N(!1)},te=()=>{x(g),N(!1),j({}),S(!0)};o.useEffect(()=>{I.current||(I.current=!0,E())},[]);const E=async()=>{var t,a;m(!0);try{const s=await h.get("/employeetype"),n=(a=(t=s==null?void 0:s.data)==null?void 0:t.list)==null?void 0:a.sort((he,ue)=>new Date(ue.createdDate)-new Date(he.createdDate));X(n)}catch(s){G(!1),console.error("Error fetching table data",s)}finally{m(!1)}},se=async()=>{try{const t=await h.get("/employeetype/exportexcel",{responseType:"blob"}),a=new Blob([t.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),s=window.URL.createObjectURL(a),n=document.createElement("a");n.href=s,n.setAttribute("download","employeeType.xlsx"),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(s)}catch(t){console.error("Error downloading the file:",t),alert("Failed to export file.")}},F=(t,a)=>{x(s=>({...s,[t]:a})),j(s=>({...s,[t]:""}))},ae=(t,a)=>{P(s=>({...s,[t]:a})),O(s=>({...s,[t]:""}))},oe=()=>{const{empTypeName:t,empTypeShortName:a}=l,s={};let n=!0;return t?/^[a-zA-Z ]+$/.test(t)||(s.empTypeName="Name must contain only letters",n=!1):(n=!1,s.empTypeName="Employee type name is required."),a||(n=!1,s.empTypeShortName="Short name is required."),j(s),n},re=()=>{const{File:t}=D,a={};let s=!0;return t?t.type!=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&&(s=!1,a.File="Only .xlsx files are allowed."):(s=!1,a.File="Import file is required."),O(a),s},ne=t=>{N(!0),x({empTypeId:t.empTypeId,empTypeName:t.empTypeName,empTypeShortName:t.empTypeShortName,isActive:t.isActive}),S(!0)},le=(t,a)=>{C({id:t,name:a}),w(!0)},ie=()=>{y&&(m(!0),h.delete(`/employeetype/${y.id}`).then(t=>{u.success(t.data.successMessage||"Employee type deleted successfully!"),E()}).catch(t=>{console.error("Error deleting employee type:",t),u.error("Failed to delete employee type.")}).finally(()=>{m(!1),w(!1),C(null)}))},M=()=>{w(!1),C(null)},ce=[{name:e.jsx("h5",{children:"Emp Type Name"}),selector:t=>t.empTypeName,sortable:!0},{name:e.jsx("h5",{children:"Emp short Name"}),selector:t=>t.empTypeShortName,sortable:!0},{name:e.jsx("h5",{children:"Status"}),cell:t=>e.jsx("span",{style:{color:t.isActive?"#88E788":"#FF474C",fontWeight:"bold"},children:t.isActive?"Active":"Inactive"}),sortable:!0},{name:e.jsx("h5",{children:"Action"}),center:!0,cell:t=>e.jsxs(e.Fragment,{children:[(r==null?void 0:r.write)&&e.jsx(U,{className:"action-icon",onClick:()=>ne(t),children:e.jsx(Se,{size:24,color:"#87CEEB"})}),(r==null?void 0:r.delete)&&e.jsx(U,{className:"action-icon",onClick:()=>le(t.empTypeId,t.empTypeName),children:e.jsx(ge,{size:30,style:{margin:"1vh"},color:"#FF474C"})})]})}],me=o.useMemo(()=>e.jsxs("div",{className:"d-flex justify-content-end gap-2 align-items-center w-100",children:[e.jsx(i,{className:"d-flex",children:e.jsx(i.Control,{type:"search",placeholder:"Search...",className:"me-2 rounded-pill","aria-label":"Search",onChange:t=>W(t.target.value)})}),(r==null?void 0:r.import)&&e.jsxs(f,{variant:"info",onClick:Q,children:[e.jsx(Ee,{size:20})," Import"]}),(r==null?void 0:r.export)&&e.jsxs(f,{variant:"success",onClick:se,children:[e.jsx(Fe,{size:20})," Export"]}),(r==null?void 0:r.write)&&e.jsxs(f,{variant:"warning",onClick:te,children:[e.jsx(Ce,{size:20})," Add"]})]}),[r,H]),pe=async t=>{if(t.preventDefault(),!oe())return;const a={empTypeName:l.empTypeName,empTypeShortName:l.empTypeShortName,isActive:l.isActive};m(!0);try{let s;v?s=await h.put(`/employeetype/${l.empTypeId}`,a):s=await h.post("/employeetype",a),x(g),N(!1),R(),E(),u.success(s.data.successMessage||"Success!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch{u.error(res.data.ErrorMessage||"Something went wrong! Please try again.",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}finally{m(!1)}},de=async t=>{if(t.preventDefault(),!re())return;const a=new FormData;a.append("File",D.File),m(!0);try{const s=await h.post("/employeetype/importexcel",a);u.success(s.data.successMessage||"File uploaded successfully!"),B(),P(A)}catch{u.error("Something went wrong! Please try again.")}finally{m(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(we,{}),ee&&e.jsx("div",{className:"modal fade show",style:{display:"block",backgroundColor:"rgba(0, 0, 0, 0.5)",transition:"opacity 0.3s ease-in-out"},tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content border-0 shadow-lg rounded-4 animate__animated animate__fadeInDown",children:[e.jsxs("div",{className:"modal-header bg-danger text-white rounded-top-4",children:[e.jsxs("h5",{className:"modal-title d-flex align-items-center gap-2",children:[e.jsx(je,{}),"Confirm Deletion"]}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:M})]}),e.jsx("div",{className:"modal-body text-center",children:e.jsxs("p",{className:"fs-5 mb-0",children:["Are you sure you want to delete"," ",e.jsx("strong",{children:y==null?void 0:y.name}),"?"]})}),e.jsxs("div",{className:"modal-footer justify-content-center border-0 pb-4",children:[e.jsxs("button",{type:"button",className:"btn btn-secondary rounded text-white px-4 d-flex align-items-center gap-2",onClick:M,children:[e.jsx(Ne,{}),"Cancel"]}),e.jsxs("button",{type:"button",className:"btn btn-danger text-white rounded px-4 shadow d-flex align-items-center gap-2",onClick:ie,children:[e.jsx(Te,{}),"Yes, Delete"]})]})]})})}),K?e.jsxs("div",{className:"d-flex justify-content-center",style:{marginTop:"20%"},children:[e.jsx(T,{animation:"grow",variant:"secondary",size:"sm"}),e.jsx(T,{animation:"grow",variant:"warning"}),e.jsx(T,{animation:"grow",variant:"secondary",size:"sm"}),e.jsx(T,{animation:"grow",variant:"warning"})]}):e.jsx("div",{className:"d-flex",children:e.jsx("div",{className:"p-3",style:{width:"100vw"},children:e.jsx("div",{style:{width:"100%"},children:e.jsx(ye,{className:"DataTable",columns:ce,data:k.filterItems($,Z,H),pagination:!0,paginationPerPage:k.paginationPerPage,paginationRowsPerPageOptions:k.paginationRowsPerPageOptions,progressPending:q,subHeader:!0,fixedHeaderScrollHeight:"400px",subHeaderComponent:me,persistTableHead:!0})})})}),e.jsxs(p,{show:Y,onHide:R,placement:"end",backdrop:"false",style:{"--bs-offcanvas-width":"800px"},children:[e.jsx(p.Header,{closeButton:!0,children:e.jsx("div",{className:"w-100 text-center",children:e.jsx(p.Title,{style:{fontSize:"30px",fontWeight:600},children:v?"Edit Employee Type":"Add Employee Type"})})}),e.jsx(p.Body,{style:{marginTop:"-2vh"},children:e.jsxs(i,{className:"h-90",onSubmit:pe,children:[e.jsxs(d,{className:"mb-4",children:[e.jsx(d.Text,{id:"empTypeName",children:e.jsx(fe,{size:25,color:"#ffc800"})}),e.jsx(i.Control,{name:"empTypeName",value:l.empTypeName||"",onChange:t=>F("empTypeName",t.target.value.replace(/[^a-zA-Z ]/g,"")),placeholder:"Employee type name","aria-label":"empTypeName",isInvalid:!!c.empTypeName,isValid:l.empTypeName&&!c.empTypeName,autoComplete:"off"}),c.empTypeName&&e.jsx("span",{className:"error-msg",children:c.empTypeName})]}),e.jsxs(d,{className:"mb-3",children:[e.jsx(d.Text,{id:"empTypeShortName",children:e.jsx(be,{size:25,color:"#ffc800"})}),e.jsx(i.Control,{name:"empTypeShortName",value:l.empTypeShortName||"",onChange:t=>F("empTypeShortName",t.target.value),placeholder:"Employee type short name","aria-label":"empTypeShortName",isInvalid:!!c.empTypeShortName,isValid:l.empTypeShortName&&!c.empTypeShortName,autoComplete:"off"}),c.empTypeShortName&&e.jsx("span",{className:"error-msg",children:c.empTypeShortName})]}),e.jsxs(d,{className:"mb-3",children:[e.jsx(d.Text,{id:"isActive",children:e.jsx(ke,{size:25,color:"#ffc800"})}),e.jsxs(i.Check,{type:"checkbox",id:"custom-checkbox",label:"IsActive",name:"isActive",className:"ms-3",style:{display:"flex",alignItems:"center",fontSize:"1rem"},custom:"true",children:[e.jsx(i.Check.Input,{type:"checkbox",checked:l.isActive,onChange:t=>F("isActive",t.target.checked),style:{width:"20px",height:"20px",cursor:"pointer",marginRight:"8px"}}),e.jsx(i.Check.Label,{htmlFor:"custom-checkbox",children:"IsActive"})]})]}),e.jsx("div",{className:"d-flex justify-content-center mt-4",children:e.jsx(f,{type:"submit",variant:"warning",children:v?"Update":"Save"})})]})})]}),e.jsxs(p,{show:J,onHide:B,backdrop:"static",placement:"end",children:[e.jsx(p.Header,{closeButton:!0,children:e.jsx("div",{className:"w-100 text-center",children:e.jsx(p.Title,{style:{fontSize:"30px",fontWeight:600},children:"Add File"})})}),e.jsx(p.Body,{style:{marginTop:"-2vh"},children:e.jsxs(i,{className:"h-90",children:[e.jsxs(d,{className:"mb-3",children:[e.jsx(d.Text,{children:e.jsx(ve,{size:25,color:"#ffc800"})}),e.jsx(i.Control,{type:"file",accept:".xlsx",name:"File",onChange:t=>{const a=t.target.files[0];ae("File",a)}}),z.File&&e.jsx("span",{className:"error-msg",children:z.File})]}),e.jsx("div",{className:"d-flex justify-content-center mt-5",children:e.jsx(f,{type:"submit",variant:"warning",onClick:de,children:"Save"})})]})})]})]})};export{Ge as default};
